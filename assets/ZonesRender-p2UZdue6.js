import{On as e}from"./css-CAVY2Ch7.js";import{S as t,U as n,V as r,Z as i,_t as a,g as o,it as s,j as c,p as l,v as u}from"./index-DAVjsRhT.js";import{B as d,Jt as f,R as p,a as m,b as h,i as g,o as _,r as v}from"./css-DaeO0X3J.js";import{n as y,o as b,s as x}from"./common-C0vyiXGj.js";import{t as S}from"./Vector-1vNBGmA0.js";const C=[73.62,16.7,134.77,53.56];function w(e){return e.reduce((e,t)=>(t.checked&&e.push(t.id),t.children&&t.children.length>0&&e.push(...w(t.children)),e),[])}var T={class:`zones-render`},E=[`title`],D={__name:`index`,props:{treeDefaultProps:{type:Object,default:()=>({children:`children`,label:`label`})},data:{type:Array,default:()=>[]},name:{type:String,default:`zones-render`},visible:{type:Boolean,default:!1}},emits:[`popup`,`closePopup`],setup(e,{emit:D}){let O=e,k=t(`state`),A=t(`isMapCreated`),j=i(null),M=D,N=i(w(O.data)),P=null,F=null,I=new h({wrapX:!1}),L=new g({fill:new _({color:`rgba(255, 0, 0, 0.05)`}),stroke:new m({color:`rgba(255, 0, 0)`,width:.5})}),R=new S({source:I,zIndex:99,visible:O.visible,properties:{name:`${O.name}-zone`}}),z=new h({wrapX:!1}),B=new g({stroke:new m({color:`rgba(255, 0, 0)`,width:1,lineDash:[10,10]}),text:new v({placement:`line`,textAlign:`center`,textBaseline:`middle`,font:`bold 11px sans-serif`,fill:new _({color:`red`}),stroke:new m({color:`white`,width:3}),overflow:!0})}),V=new S({cmSource:z,zIndex:99,visible:O.visible,properties:{name:`${O.name}-cm`}});r(A,e=>{e&&(P=k.map,H())}),r(()=>O.visible,e=>{R.setVisible(e),y(F),e&&(K(),M(`closePopup`),j.value.getCurrentKey()&&j.value.setCurrentKey(null))});function H(){F=b(P,`highlight`).getSource(),P.addLayer(R),P.addLayer(V),O.data.forEach(e=>{e?.bounds&&(U(e),W(e)),e?.children?.length&&e.children.forEach(e=>{e?.bounds&&(U(e),W(e))})}),O.visible&&K()}function U(e){let t=new f({geometry:p(e.bounds)});t.setId(e.code),t.setStyle(L.clone()),t.setProperties({...e}),I.addFeature(t)}function W(e){let t=new f({geometry:new d(q(e.bounds))}),n=B.clone();n.getText().setText(e.centralMeridian??``),t.setStyle(n),I.addFeature(t)}function G(e){if(!e.bounds)return;let t=I.getFeatureById(e.code);if(t){y(F);let n=t.clone();n.setStyle(void 0),F.addFeature(n),P.getView().fit(t.getGeometry(),{duration:300,padding:[20,340,20,450],callback:()=>M(`popup`,e)})}}function K(){P.getView().fit(C,{duration:300,padding:[20,340,20,450]})}let q=(e,t=2)=>{if(!Array.isArray(e)||e.length!==4)return null;let[n,r,i,a]=e,o=n===132||n===133.5?135:(n+i)/2;return[[o,a+t],[o,r-t]]};return(t,r)=>{let i=x;return c(),o(`div`,T,[u(i,{ref_key:`treeRef`,ref:j,class:`custom-tree`,data:e.data,"node-key":`id`,props:e.treeDefaultProps,"default-expanded-keys":[1],"default-checked-keys":s(N),onNodeClick:G,"highlight-current":``},{default:n(({node:e,data:t})=>[l(`span`,{title:e.label},a(e.label),9,E)]),_:1},8,[`data`,`props`,`default-checked-keys`])])}}};export{D as t};