import{$ as e,$t as t,A as n,At as r,B as i,Bt as a,C as o,D as s,E as c,Ft as l,G as u,H as d,Ht as f,I as p,It as m,J as h,Jt as g,K as _,Kt as v,Lt as y,M as b,Nt as x,O as S,Ot as C,P as w,Pt as T,Q as E,Qt as D,S as ee,St as O,T as k,Tt as te,Ut as A,Wt as j,Y as ne,Yt as re,Z as ie,Zt as ae,_ as oe,_t as se,an as ce,at as le,b as ue,bt as de,ct as fe,d as pe,dn as me,en as he,et as M,f as ge,fn as _e,ft as ve,g as ye,gt as be,h as xe,hn as Se,ht as N,i as Ce,in as we,j as P,jt as Te,k as Ee,lt as De,mn as Oe,n as ke,nn as Ae,nt as je,o as Me,on as Ne,pt as F,q as Pe,qt as Fe,rt as Ie,tt as Le,u as Re,ut as I,vt as ze,w as Be,wt as Ve,x as He,xt as Ue,y as We,z as Ge}from"./extent-D6dXpXWi.js";import{C as Ke,D as qe,E as Je,I as Ye,K as L,O as Xe,Q as R,R as Ze,S as Qe,V as $e,W as et,Z as tt,_ as nt,a as rt,at as it,c as z,ct as at,d as ot,f as st,g as ct,h as lt,it as ut,k as dt,l as ft,lt as pt,m as mt,n as ht,nt as gt,ot as _t,p as vt,r as yt,rt as bt,s as xt,st as St,t as Ct,v as wt,x as Tt,z as Et}from"./index-CS_7Xx1B.js";import{A as Dt,At as Ot,Bt as kt,Ct as At,D as jt,Dt as Mt,E as Nt,F as Pt,Ft,Gt as It,Ht as Lt,It as Rt,Jt as zt,Kt as Bt,L as Vt,Lt as Ht,Mt as Ut,N as Wt,Nt as Gt,O as B,P as Kt,Pt as qt,Qt as Jt,St as Yt,T as Xt,Ut as V,Wt as Zt,X as H,Xt as Qt,Y as U,Zt as $t,_t as W,at as en,bt as tn,ct as nn,et as rn,ft as an,gt as on,ht as sn,it as cn,jt as ln,k as un,lt as dn,mt as fn,nt as pn,o as mn,pt as hn,qt as gn,rt as _n,st as vn,t as yn,tt as bn,ut as xn,vt as Sn,w as Cn,wt as wn,xt as Tn,yt as En,zt as Dn}from"./BaseVector-DU5lzx9D.js";import{t as G}from"./MapEventType-B0kHgABJ.js";var On=Symbol(),kn={current:0},An=L(0),jn=2e3,Mn=Symbol(`elZIndexContextKey`),Nn=Symbol(`zIndexContextKey`),Pn=e=>{let n=ct()?wt(Mn,kn):kn,r=e||(ct()?wt(Nn,void 0):void 0),i=z(()=>{let e=R(r);return Ne(e)?e:jn}),a=z(()=>i.value+An.value);return!we&&!wt(Mn)&&t(`ZIndexInjection`,`Looks like you are using server rendering, you must provide a z-index provider to ensure the hydration process to be succeed
usage: app.provide(ZINDEX_INJECTION_KEY, { current: 0 })`),{initialZIndex:i,currentZIndex:a,nextZIndex:()=>(n.current++,An.value=n.current,a.value)}},Fn=Symbol(`emptyValuesContextKey`);ae({emptyValues:Array,valueOnClear:{type:D([String,Number,Boolean,Function]),default:void 0,validator:e=>(e=ut(e)?e():e,bt(e)?e.every(e=>!e):!e)}});var In=L();function Ln(e,t=void 0){let n=ct()?wt(On,In):In;return e?z(()=>n.value?.[e]??t):n}function Rn(e,t){let n=Ln(),r=Oe(e,z(()=>n.value?.namespace||`el`)),i=Jt(z(()=>n.value?.locale)),a=Pn(z(()=>n.value?.zIndex||2e3)),o=z(()=>R(t)||n.value?.size||``);return zn(z(()=>R(n)||{})),{ns:r,locale:i,zIndex:a,size:o}}var zn=(e,n,r=!1)=>{let i=!!ct(),a=i?Ln():void 0,o=n?.provide??(i?qe:void 0);if(!o){t(`provideGlobalConfig`,`provideGlobalConfig() can only be used inside setup().`);return}let s=z(()=>{let t=R(e);return a?.value?Bn(a.value,t):t});return o(On,s),o($t,z(()=>s.value.locale)),o(_e,z(()=>s.value.namespace)),o(Nn,z(()=>s.value.zIndex)),o(g,{size:z(()=>s.value.size||``)}),o(Fn,z(()=>({emptyValues:s.value.emptyValues,valueOnClear:s.value.valueOnClear}))),(r||!In.value)&&(In.value=s.value),s},Bn=(e,t)=>{let n=[...new Set([...Fe(e),...Fe(t)])],r={};for(let i of n)r[i]=t[i]===void 0?e[i]:t[i];return r},Vn={label:`label`,value:`value`,disabled:`disabled`},Hn=ae({direction:{type:D(String),default:`horizontal`},options:{type:D(Array),default:()=>[]},modelValue:{type:[String,Number,Boolean],default:void 0},props:{type:D(Object),default:()=>Vn},block:Boolean,size:re,disabled:{type:Boolean,default:void 0},validateEvent:{type:Boolean,default:!0},id:String,name:String,...gn([`ariaLabel`])}),Un={[Qt]:e=>_t(e)||Ne(e)||ce(e),[zt]:e=>_t(e)||Ne(e)||ce(e)},Wn=[`id`,`aria-label`,`aria-labelledby`],Gn=[`name`,`disabled`,`checked`,`onChange`],Kn=j(v(lt({name:`ElSegmented`,__name:`segmented`,props:Hn,emits:Un,setup(e,{emit:n}){let r=e,i=n,a=Oe(`segmented`),o=Bt(),s=y(),c=m(),{formItem:l}=Zt(),{inputId:u,isLabeledByFormItem:d}=It(r,{formItemContext:l}),f=L(null),p=he(),h=et({isInit:!1,width:0,height:0,translateX:0,translateY:0,focusVisible:!1}),g=(e,t)=>{let n=b(t);i(Qt,n),i(zt,n),e.target.checked=n===r.modelValue},_=z(()=>({...Vn,...r.props})),v=e=>e,b=e=>it(e)?e[_.value.value]:e,x=e=>it(e)?e[_.value.label]:e,S=e=>!!(c.value||it(e)&&e[_.value.disabled]),C=e=>r.modelValue===b(e),w=e=>r.options.find(t=>b(t)===e),T=e=>[a.e(`item`),a.is(`selected`,C(e)),a.is(`disabled`,S(e))],E=()=>{if(!f.value)return;let e=f.value.querySelector(`.is-selected`),t=f.value.querySelector(`.is-selected input`);if(!e||!t){h.width=0,h.height=0,h.translateX=0,h.translateY=0,h.focusVisible=!1;return}h.isInit=!0,r.direction===`vertical`?(h.height=e.offsetHeight,h.translateY=e.offsetTop):(h.width=e.offsetWidth,h.translateX=e.offsetLeft);try{h.focusVisible=t.matches(`:focus-visible`)}catch{}},D=z(()=>[a.b(),a.m(s.value),a.is(`block`,r.block)]),ee=z(()=>({width:r.direction===`vertical`?`100%`:`${h.width}px`,height:r.direction===`vertical`?`${h.height}px`:`100%`,transform:r.direction===`vertical`?`translateY(${h.translateY}px)`:`translateX(${h.translateX}px)`,display:h.isInit?`block`:`none`})),O=z(()=>[a.e(`item-selected`),a.is(`disabled`,S(w(r.modelValue))),a.is(`focus-visible`,h.focusVisible)]),k=z(()=>r.name||o.value);return Ae(f,E),Ye(p,E),Ye(()=>r.modelValue,()=>{var e;E(),r.validateEvent&&((e=l?.validate)==null||e.call(l,`change`).catch(e=>t(e)))},{flush:`post`}),(e,t)=>e.options.length?(Je(),st(`div`,{key:0,id:R(u),ref_key:`segmentedRef`,ref:f,class:St(D.value),role:`radiogroup`,"aria-label":R(d)?void 0:e.ariaLabel||`segmented`,"aria-labelledby":R(d)?R(l).labelId:void 0},[ft(`div`,{class:St([R(a).e(`group`),R(a).m(e.direction)])},[ft(`div`,{style:at(ee.value),class:St(O.value)},null,6),(Je(!0),st(xt,null,Xe(e.options,(t,n)=>(Je(),st(`label`,{key:n,class:St(T(t))},[ft(`input`,{class:St(R(a).e(`item-input`)),type:`radio`,name:k.value,disabled:S(t),checked:C(t),onChange:e=>g(e,t)},null,42,Gn),ft(`div`,{class:St(R(a).e(`item-label`))},[dt(e.$slots,`default`,{item:v(t)},()=>[vt(pt(x(t)),1)])],2)],2))),128))],2)],10,Wn)):ot(`v-if`,!0)}}),[[`__file`,`/home/runner/work/element-plus/element-plus/packages/components/segmented/src/segmented.vue`]]));function qn(e,t){let n,r=L(!1),i=et({...e,originalPosition:``,originalOverflow:``,visible:!1});function a(e){i.text=e}function o(){let e=i.parent,t=d.ns;if(!e.vLoadingAddClassList){let n=e.getAttribute(`loading-number`);n=Number.parseInt(n)-1,n?e.setAttribute(`loading-number`,n.toString()):(A(e,t.bm(`parent`,`relative`)),e.removeAttribute(`loading-number`)),A(e,t.bm(`parent`,`hidden`))}s(),u.unmount()}function s(){var e;(e=d.$el?.parentNode)==null||e.removeChild(d.$el)}function c(){var t;e.beforeClose&&!e.beforeClose()||(r.value=!0,clearTimeout(n),n=setTimeout(l,400),i.visible=!1,(t=e.closed)==null||t.call(e))}function l(){if(!r.value)return;let e=i.parent;r.value=!1,e.vLoadingAddClassList=void 0,o()}let u=yt(lt({name:`ElLoading`,setup(e,{expose:t}){let{ns:n,zIndex:r}=Rn(`loading`);return t({ns:n,zIndex:r}),()=>{let e=i.spinner||i.svg,t=nt(`svg`,{class:`circular`,viewBox:i.svgViewBox?i.svgViewBox:`0 0 50 50`,...e?{innerHTML:e}:{}},[nt(`circle`,{class:`path`,cx:`25`,cy:`25`,r:`20`,fill:`none`})]),r=i.text?nt(`p`,{class:n.b(`text`)},[i.text]):void 0;return nt(ht,{name:n.b(`fade`),onAfterLeave:l},{default:Ze(()=>[Et(mt(`div`,{style:{backgroundColor:i.background||``},class:[n.b(`mask`),i.customClass,n.is(`fullscreen`,i.fullscreen)]},[nt(`div`,{class:n.b(`spinner`)},[t,r])]),[[rt,i.visible]])])})}}}));Object.assign(u._context,t??{});let d=u.mount(document.createElement(`div`));return{...tt(i),setText:a,removeElLoadingChild:s,close:c,handleAfterLeave:l,vm:d,get $el(){return d.$el}}}var Jn=void 0,Yn=function(e={},t){if(!we)return;let n=Xn(e);if(n.fullscreen&&Jn)return Jn;let r=qn({...n,closed:()=>{var e;(e=n.closed)==null||e.call(n),n.fullscreen&&(Jn=void 0)}},t??Yn._context);Zn(n,n.parent,r),Qn(n,n.parent,r),n.parent.vLoadingAddClassList=()=>Qn(n,n.parent,r);let i=n.parent.getAttribute(`loading-number`);return i=i?`${Number.parseInt(i)+1}`:`1`,n.parent.setAttribute(`loading-number`,i),n.parent.appendChild(r.$el),Tt(()=>r.visible.value=n.visible),n.fullscreen&&(Jn=r),r},Xn=e=>{let t;return t=_t(e.target)?document.querySelector(e.target)??document.body:e.target||document.body,{parent:t===document.body||e.body?document.body:t,background:e.background||``,svg:e.svg||``,svgViewBox:e.svgViewBox||``,spinner:e.spinner||!1,text:e.text||``,fullscreen:t===document.body&&(e.fullscreen??!0),lock:e.lock??!1,customClass:e.customClass||``,visible:e.visible??!0,beforeClose:e.beforeClose,closed:e.closed,target:t}},Zn=async(e,t,n)=>{let{nextZIndex:r}=n.vm.zIndex||n.vm._.exposed.zIndex,i={};if(e.fullscreen)n.originalPosition.value=f(document.body,`position`),n.originalOverflow.value=f(document.body,`overflow`),i.zIndex=r();else if(e.parent===document.body){n.originalPosition.value=f(document.body,`position`),await Tt();for(let t of[`top`,`left`]){let n=t===`top`?`scrollTop`:`scrollLeft`;i[t]=`${e.target.getBoundingClientRect()[t]+document.body[n]+document.documentElement[n]-Number.parseInt(f(document.body,`margin-${t}`),10)}px`}for(let t of[`height`,`width`])i[t]=`${e.target.getBoundingClientRect()[t]}px`}else n.originalPosition.value=f(t,`position`);for(let[e,t]of Object.entries(i))n.$el.style[e]=t},Qn=(e,t,n)=>{let r=n.vm.ns||n.vm._.exposed.ns;[`absolute`,`fixed`,`sticky`].includes(n.originalPosition.value)?A(t,r.bm(`parent`,`relative`)):a(t,r.bm(`parent`,`relative`)),e.fullscreen&&e.lock?a(t,r.bm(`parent`,`hidden`)):A(t,r.bm(`parent`,`hidden`))};Yn._context=null;var $n=Symbol(`ElLoading`),K=e=>`element-loading-${gt(e)}`,er=(e,t)=>{let n=t.instance,r=e=>it(t.value)?t.value[e]:void 0,i=e=>L(_t(e)&&n?.[e]||e),a=t=>i(r(t)||e.getAttribute(K(t))),o=r(`fullscreen`)??t.modifiers.fullscreen,s={text:a(`text`),svg:a(`svg`),svgViewBox:a(`svgViewBox`),spinner:a(`spinner`),background:a(`background`),customClass:a(`customClass`),fullscreen:o,target:r(`target`)??(o?void 0:e),body:r(`body`)??t.modifiers.body,lock:r(`lock`)??t.modifiers.lock},c=Yn(s);c._context=nr._context,e[$n]={options:s,instance:c}},tr=(e,t)=>{for(let n of Object.keys(e))$e(e[n])&&(e[n].value=t[n])},nr={mounted(e,t){t.value&&er(e,t)},updated(e,t){let n=e[$n];if(!t.value){n?.instance.close(),e[$n]=null;return}n?tr(n.options,it(t.value)?t.value:{text:e.getAttribute(K(`text`)),svg:e.getAttribute(K(`svg`)),svgViewBox:e.getAttribute(K(`svgViewBox`)),spinner:e.getAttribute(K(`spinner`)),background:e.getAttribute(K(`background`)),customClass:e.getAttribute(K(`customClass`))}):er(e,t)},unmounted(e){var t;(t=e[$n])==null||t.instance.close(),e[$n]=null}};nr._context=null;var rr=class{constructor(e){this.highWaterMark=e===void 0?2048:e,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){let e=this.pop();e instanceof x&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){let n=this.entries_[e];return V(n!==void 0,`Tried to get a value for a key that does not exist in the cache`),n===this.newest_?n.value_:(n===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(n.newer.older=n.older,n.older.newer=n.newer),n.newer=null,n.older=this.newest_,this.newest_.newer=n,this.newest_=n,n.value_)}remove(e){let t=this.entries_[e];return V(t!==void 0,`Tried to get a value for a key that does not exist in the cache`),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){let e=Array(this.count_),t=0,n;for(n=this.newest_;n;n=n.older)e[t++]=n.key_;return e}getValues(){let e=Array(this.count_),t=0,n;for(n=this.newest_;n;n=n.older)e[t++]=n.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){return this.entries_[e]?.value_}pop(){let e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){V(!(e in this.entries_),`Tried to set a value for a key that is used already`);let n={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=n:this.oldest_=n,this.newest_=n,this.entries_[e]=n,++this.count_}setSize(e){this.highWaterMark=e}};function ir(e,t,n,r){return r===void 0?[e,t,n]:(r[0]=e,r[1]=t,r[2]=n,r)}function ar(e,t,n){return e+`/`+t+`/`+n}function or(e,t,n,r,i){return`${I(e)},${t},${ar(n,r,i)}`}function sr(e){return cr(e[0],e[1],e[2])}function cr(e,t,n){return(t<<e)+n}function lr(e,t){let n=e[0],r=e[1],i=e[2];if(t.getMinZoom()>n||n>t.getMaxZoom())return!1;let a=t.getFullTileRange(n);return a?a.containsXY(r,i):!0}var ur=class{constructor(e,t,n,r){this.minX=e,this.maxX=t,this.minY=n,this.maxY=r}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}};function dr(e,t,n,r,i){return i===void 0?new ur(e,t,n,r):(i.minX=e,i.maxX=t,i.minY=n,i.maxY=r,i)}var fr=ur,pr=[0,0,0],q=5,mr=class{constructor(e){this.minZoom=e.minZoom===void 0?0:e.minZoom,this.resolutions_=e.resolutions,V(r(this.resolutions_,(e,t)=>t-e,!0),"`resolutions` must be sorted in descending order");let t;if(!e.origins){for(let e=0,n=this.resolutions_.length-1;e<n;++e)if(!t)t=this.resolutions_[e]/this.resolutions_[e+1];else if(this.resolutions_[e]/this.resolutions_[e+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin===void 0?null:e.origin,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,V(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));let n=e.extent;n!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=Ee(n)),V(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,V(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize===void 0?this.tileSizes_?null:256:e.tileSize,V(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=n===void 0?null:n,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes===void 0?n&&this.calculateTileRanges_(n):this.fullTileRanges_=e.sizes.map((e,t)=>{let r=new fr(Math.min(0,e[0]),Math.max(e[0]-1,-1),Math.min(0,e[1]),Math.max(e[1]-1,-1));if(n){let e=this.getTileRangeForExtentAndZ(n,t);r.minX=Math.max(e.minX,r.minX),r.maxX=Math.min(e.maxX,r.maxX),r.minY=Math.max(e.minY,r.minY),r.maxY=Math.min(e.maxY,r.maxY)}return r})}forEachTileCoord(e,t,n){let r=this.getTileRangeForExtentAndZ(e,t);for(let e=r.minX,i=r.maxX;e<=i;++e)for(let i=r.minY,a=r.maxY;i<=a;++i)n([t,e,i])}forEachTileCoordParentTileRange(e,t,n,r){let i,a,o,s=null,c=e[0]-1;for(this.zoomFactor_===2?(a=e[1],o=e[2]):s=this.getTileCoordExtent(e,r);c>=this.minZoom;){if(a!==void 0&&o!==void 0?(a=Math.floor(a/2),o=Math.floor(o/2),i=dr(a,a,o,o,n)):i=this.getTileRangeForExtentAndZ(s,c,n),t(c,i))return!0;--c}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,n){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){let n=e[1]*2,r=e[2]*2;return dr(n,n+1,r,r+1,t)}let r=this.getTileCoordExtent(e,n||this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,n){if(t>this.maxZoom||t<this.minZoom)return null;let r=e[0],i=e[1],a=e[2];if(t===r)return dr(i,a,i,a,n);if(this.zoomFactor_){let e=this.zoomFactor_**+(t-r),o=Math.floor(i*e),s=Math.floor(a*e);return t<r?dr(o,o,s,s,n):dr(o,Math.floor(e*(i+1))-1,s,Math.floor(e*(a+1))-1,n)}let o=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(o,t,n)}getTileRangeForExtentAndZ(e,t,n){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,pr);let r=pr[1],i=pr[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,pr);let a=pr[1],o=pr[2];return dr(r,a,i,o,n)}getTileCoordCenter(e){let t=this.getOrigin(e[0]),n=this.getResolution(e[0]),r=W(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*r[0]*n,t[1]-(e[2]+.5)*r[1]*n]}getTileCoordExtent(e,t){let n=this.getOrigin(e[0]),r=this.getResolution(e[0]),i=W(this.getTileSize(e[0]),this.tmpSize_),a=n[0]+e[1]*i[0]*r,o=n[1]-(e[2]+1)*i[1]*r;return pe(a,o,a+i[0]*r,o+i[1]*r,t)}getTileCoordForCoordAndResolution(e,t,n){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,n)}getTileCoordForXYAndResolution_(e,t,n,r,i){let a=this.getZForResolution(n),o=n/this.getResolution(a),s=this.getOrigin(a),c=W(this.getTileSize(a),this.tmpSize_),l=o*(e-s[0])/n/c[0],u=o*(s[1]-t)/n/c[1];return r?(l=Ft(l,q)-1,u=Ft(u,q)-1):(l=Ht(l,q),u=Ht(u,q)),ir(a,l,u,i)}getTileCoordForXYAndZ_(e,t,n,r,i){let a=this.getOrigin(n),o=this.getResolution(n),s=W(this.getTileSize(n),this.tmpSize_),c=(e-a[0])/o/s[0],l=(a[1]-t)/o/s[1];return r?(c=Ft(c,q)-1,l=Ft(l,q)-1):(c=Ht(c,q),l=Ht(l,q)),ir(n,c,l,i)}getTileCoordForCoordAndZ(e,t,n){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,n)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){return Rt(Te(this.resolutions_,e,t||0),this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return fn(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){let t=this.resolutions_.length,n=Array(t);for(let r=this.minZoom;r<t;++r)n[r]=this.getTileRangeForExtentAndZ(e,r);this.fullTileRanges_=n}},hr=class extends mr{constructor(e){super({extent:e.extent,origin:e.origin,origins:e.origins,resolutions:e.resolutions,tileSize:e.tileSize,tileSizes:e.tileSizes,sizes:e.sizes}),this.matrixIds_=e.matrixIds}getMatrixId(e){return this.matrixIds_[e]}getMatrixIds(){return this.matrixIds_}};function gr(e){let t=e.getDefaultTileGrid();return t||(t=xr(e),e.setDefaultTileGrid(t)),t}function _r(e,t,n){let r=t[0],i=e.getTileCoordCenter(t),a=Sr(n);if(!Me(a,i)){let t=P(a),n=Math.ceil((a[0]-i[0])/t);return i[0]+=t*n,e.getTileCoordForCoordAndZ(i,r)}return t}function vr(e,t,n,r){r=r===void 0?`top-left`:r;let i=br(e,t,n);return new mr({extent:e,origin:Be(e,r),resolutions:i,tileSize:n})}function yr(e){let t=e||{},n=t.extent||Yt(`EPSG:3857`).getExtent();return new mr({extent:n,minZoom:t.minZoom,tileSize:t.tileSize,resolutions:br(n,t.maxZoom,t.tileSize,t.maxResolution)})}function br(e,t,n,r){t=t===void 0?42:t,n=W(n===void 0?256:n);let i=c(e),a=P(e);r=r>0?r:Math.max(a/n[0],i/n[1]);let o=t+1,s=Array(o);for(let e=0;e<o;++e)s[e]=r/2**e;return s}function xr(e,t,n,r){return vr(Sr(e),t,n,r)}function Sr(e){e=Yt(e);let t=e.getExtent();if(!t){let n=180*ln.degrees/e.getMetersPerUnit();t=pe(-n,-n,n,n)}return t}var Cr=/\{z\}/g,wr=/\{x\}/g,Tr=/\{y\}/g,Er=/\{-y\}/g;function Dr(e,t,n,r,i){return e.replace(Cr,t.toString()).replace(wr,n.toString()).replace(Tr,r.toString()).replace(Er,function(){if(i===void 0)throw Error(`If the URL template has a {-y} placeholder, the grid extent must be known`);return(i-r).toString()})}function Or(e){let t=[],n=/\{([a-z])-([a-z])\}/.exec(e);if(n){let r=n[1].charCodeAt(0),i=n[2].charCodeAt(0),a;for(a=r;a<=i;++a)t.push(e.replace(n[0],String.fromCharCode(a)));return t}if(n=/\{(\d+)-(\d+)\}/.exec(e),n){let r=parseInt(n[2],10);for(let i=parseInt(n[1],10);i<=r;i++)t.push(e.replace(n[0],i.toString()));return t}return t.push(e),t}function kr(e,t){return(function(n,r,i){if(!n)return;let a,o=n[0];if(t){let e=t.getFullTileRange(o);e&&(a=e.getHeight()-1)}return Dr(e,o,n[1],n[2],a)})}function Ar(e,t){let n=e.length,r=Array(n);for(let i=0;i<n;++i)r[i]=kr(e[i],t);return jr(r)}function jr(e){return e.length===1?e[0]:(function(t,n,r){if(t)return e[Dn(sr(t),e.length)](t,n,r)})}var J={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4},Mr=class extends be{constructor(e,t,n){super(),n||={},this.tileCoord=e,this.state=t,this.key=``,this.transition_=n.transition===void 0?250:n.transition,this.transitionStarts_={},this.interpolate=!!n.interpolate}changed(){this.dispatchEvent(T.CHANGE)}release(){this.setState(J.EMPTY)}getKey(){return this.key+`/`+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==J.EMPTY){if(this.state!==J.ERROR&&this.state>e)throw Error(`Tile load sequence violation`);this.state=e,this.changed()}}load(){De()}getAlpha(e,t){if(!this.transition_)return 1;let n=this.transitionStarts_[e];if(!n)n=t,this.transitionStarts_[e]=n;else if(n===-1)return 1;let r=t-n+1e3/60;return r>=this.transition_?1:vn(r/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}},Nr=class extends Mr{constructor(e,t,n,r,i,a){super(e,t,a),this.crossOrigin_=r,this.src_=n,this.key=n,this.image_,M?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,r!==null&&(this.image_.crossOrigin=r)),this.unlisten_=null,this.tileLoadFunction_=i}getImage(){return this.image_}setImage(e){this.image_=e,this.state=J.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=J.ERROR,this.unlistenImage_(),this.image_=Pr(),this.changed()}handleImageLoad_(){if(M)this.state=J.LOADED;else{let e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=J.LOADED:this.state=J.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==J.ERROR&&(this.state=J.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==J.IDLE&&(this.state=J.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=xn(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&=(this.unlisten_(),null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}};function Pr(){let e=Ge(1,1);return e.fillStyle=`rgba(0,0,0,0)`,e.fillRect(0,0,1,1),e.canvas}var Fr=Nr,Ir;const Lr=[];function Rr(e,t,n,r,i){e.beginPath(),e.moveTo(0,0),e.lineTo(t,n),e.lineTo(r,i),e.closePath(),e.save(),e.clip(),e.fillRect(0,0,Math.max(t,r)+1,Math.max(n,i)),e.restore()}function zr(e,t){return Math.abs(e[t*4]-210)>2||Math.abs(e[t*4+3]-.75*255)>2}function Br(){if(Ir===void 0){let e=Ge(6,6,Lr);e.globalCompositeOperation=`lighter`,e.fillStyle=`rgba(210, 0, 0, 0.75)`,Rr(e,4,5,4,0),Rr(e,4,5,0,5);let t=e.getImageData(0,0,3,3).data;Ir=zr(t,0)||zr(t,4)||zr(t,8),u(e),Lr.push(e.canvas)}return Ir}function Vr(e,t,n,r){let i=Ot(n,t,e),a=At(t,r,n),o=t.getMetersPerUnit();o!==void 0&&(a*=o);let s=e.getMetersPerUnit();s!==void 0&&(a/=s);let c=e.getExtent();if(!c||Me(c,i)){let t=At(e,a,i)/a;isFinite(t)&&t>0&&(a/=t)}return a}function Hr(e,t,n,r){let i=Vr(e,t,o(n),r);return(!isFinite(i)||i<=0)&&We(n,function(n){return i=Vr(e,t,n,r),isFinite(i)&&i>0}),i}function Ur(e,t,n,r,i,a,o,s,l,d,f,p,m,h){let g=Ge(Math.round(n*e),Math.round(n*t),Lr);if(p||(g.imageSmoothingEnabled=!1),l.length===0)return g.canvas;g.scale(n,n);function _(e){return Math.round(e*n)/n}g.globalCompositeOperation=`lighter`;let v=Re();l.forEach(function(e,t,n){ye(v,e.extent)});let y,b=n/r,x=(p?1:1+2**-24)/b;if(!m||l.length!==1||d!==0){if(y=Ge(Math.round(P(v)*b),Math.round(c(v)*b),Lr),p||(y.imageSmoothingEnabled=!1),i&&h){let e=(i[0]-v[0])*b,t=-(i[3]-v[3])*b,n=P(i)*b,r=c(i)*b;y.rect(e,t,n,r),y.clip()}l.forEach(function(e,t,n){if(e.image.width>0&&e.image.height>0){if(e.clipExtent){y.save();let t=(e.clipExtent[0]-v[0])*b,n=-(e.clipExtent[3]-v[3])*b,r=P(e.clipExtent)*b,i=c(e.clipExtent)*b;y.rect(p?t:Math.round(t),p?n:Math.round(n),p?r:Math.round(t+r)-Math.round(t),p?i:Math.round(n+i)-Math.round(n)),y.clip()}let t=(e.extent[0]-v[0])*b,n=-(e.extent[3]-v[3])*b,r=P(e.extent)*b,i=c(e.extent)*b;y.drawImage(e.image,d,d,e.image.width-2*d,e.image.height-2*d,p?t:Math.round(t),p?n:Math.round(n),p?r:Math.round(t+r)-Math.round(t),p?i:Math.round(n+i)-Math.round(n)),e.clipExtent&&y.restore()}})}let S=Ee(o);return s.getTriangles().forEach(function(e,t,n){let r=e.source,i=e.target,o=r[0][0],s=r[0][1],u=r[1][0],d=r[1][1],f=r[2][0],m=r[2][1],h=_((i[0][0]-S[0])/a),b=_(-(i[0][1]-S[1])/a),C=_((i[1][0]-S[0])/a),w=_(-(i[1][1]-S[1])/a),T=_((i[2][0]-S[0])/a),E=_(-(i[2][1]-S[1])/a),D=o,ee=s;o=0,s=0,u-=D,d-=ee,f-=D,m-=ee;let O=kt([[u,d,0,0,C-h],[f,m,0,0,T-h],[0,0,u,d,w-b],[0,0,f,m,E-b]]);if(!O)return;if(g.save(),g.beginPath(),Br()||!p){g.moveTo(C,w);let e=h-C,t=b-w;for(let n=0;n<4;n++)g.lineTo(C+_((n+1)*e/4),w+_(n*t/3)),n!=3&&g.lineTo(C+_((n+1)*e/4),w+_((n+1)*t/3));g.lineTo(T,E)}else g.moveTo(C,w),g.lineTo(h,b),g.lineTo(T,E);g.clip(),g.transform(O[0],O[2],O[1],O[3],h,b),g.translate(v[0]-D,v[3]-ee);let k;if(y)k=y.canvas,g.scale(x,-x);else{let e=l[0],t=e.extent;k=e.image,g.scale(P(t)/k.width,-c(t)/k.height)}g.drawImage(k,0,0),g.restore()}),y&&(u(y),Lr.push(y.canvas)),f&&(g.save(),g.globalCompositeOperation=`source-over`,g.strokeStyle=`black`,g.lineWidth=1,s.getTriangles().forEach(function(e,t,n){let r=e.target,i=(r[0][0]-S[0])/a,o=-(r[0][1]-S[1])/a,s=(r[1][0]-S[0])/a,c=-(r[1][1]-S[1])/a,l=(r[2][0]-S[0])/a,u=-(r[2][1]-S[1])/a;g.beginPath(),g.moveTo(s,c),g.lineTo(i,o),g.lineTo(l,u),g.closePath(),g.stroke()}),g.restore()),g.canvas}var Wr=10,Gr=.25,Kr=class{constructor(e,t,r,i,a,o,s){this.sourceProj_=e,this.targetProj_=t;let c={},l=s?Sn(e=>bn(s,Ot(e,this.targetProj_,this.sourceProj_))):wn(this.targetProj_,this.sourceProj_);this.transformInv_=function(e){let t=e[0]+`/`+e[1];return c[t]||(c[t]=l(e)),c[t]},this.maxSourceExtent_=i,this.errorThresholdSquared_=a*a,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!i&&!!this.sourceProj_.getExtent()&&P(i)>=P(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?P(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?P(this.targetProj_.getExtent()):null;let u=Ee(r),d=n(r),f=ee(r),p=He(r),m=this.transformInv_(u),h=this.transformInv_(d),g=this.transformInv_(f),_=this.transformInv_(p),v=Wr+(o?Math.max(0,Math.ceil(Math.log2(ue(r)/(o*o*256*256)))):0);if(this.addQuad_(u,d,f,p,m,h,g,_,v),this.wrapsXInSource_){let e=1/0;this.triangles_.forEach(function(t,n,r){e=Math.min(e,t.source[0][0],t.source[1][0],t.source[2][0])}),this.triangles_.forEach(t=>{if(Math.max(t.source[0][0],t.source[1][0],t.source[2][0])-e>this.sourceWorldWidth_/2){let n=[[t.source[0][0],t.source[0][1]],[t.source[1][0],t.source[1][1]],[t.source[2][0],t.source[2][1]]];n[0][0]-e>this.sourceWorldWidth_/2&&(n[0][0]-=this.sourceWorldWidth_),n[1][0]-e>this.sourceWorldWidth_/2&&(n[1][0]-=this.sourceWorldWidth_),n[2][0]-e>this.sourceWorldWidth_/2&&(n[2][0]-=this.sourceWorldWidth_);let r=Math.min(n[0][0],n[1][0],n[2][0]);Math.max(n[0][0],n[1][0],n[2][0])-r<this.sourceWorldWidth_/2&&(t.source=n)}})}c={}}addTriangle_(e,t,n,r,i,a){this.triangles_.push({source:[r,i,a],target:[e,t,n]})}addQuad_(e,t,n,r,i,a,o,s,c){let l=ke([i,a,o,s]),u=this.sourceWorldWidth_?P(l)/this.sourceWorldWidth_:null,d=this.sourceWorldWidth_,f=this.sourceProj_.canWrapX()&&u>.5&&u<1,p=!1;if(c>0&&(this.targetProj_.isGlobal()&&this.targetWorldWidth_&&(p=P(ke([e,t,n,r]))/this.targetWorldWidth_>Gr||p),!f&&this.sourceProj_.isGlobal()&&u&&(p=u>Gr||p)),!p&&this.maxSourceExtent_&&isFinite(l[0])&&isFinite(l[1])&&isFinite(l[2])&&isFinite(l[3])&&!b(l,this.maxSourceExtent_))return;let m=0;if(!p&&(!isFinite(i[0])||!isFinite(i[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(s[0])||!isFinite(s[1]))){if(c>0)p=!0;else if(m=(!isFinite(i[0])||!isFinite(i[1])?8:0)+(!isFinite(a[0])||!isFinite(a[1])?4:0)+(!isFinite(o[0])||!isFinite(o[1])?2:0)+(!isFinite(s[0])||!isFinite(s[1])?1:0),m!=1&&m!=2&&m!=4&&m!=8)return}if(c>0){if(!p){let t=[(e[0]+n[0])/2,(e[1]+n[1])/2],r=this.transformInv_(t),a;a=f?(Dn(i[0],d)+Dn(o[0],d))/2-Dn(r[0],d):(i[0]+o[0])/2-r[0];let s=(i[1]+o[1])/2-r[1];p=a*a+s*s>this.errorThresholdSquared_}if(p){if(Math.abs(e[0]-n[0])<=Math.abs(e[1]-n[1])){let l=[(t[0]+n[0])/2,(t[1]+n[1])/2],u=this.transformInv_(l),d=[(r[0]+e[0])/2,(r[1]+e[1])/2],f=this.transformInv_(d);this.addQuad_(e,t,l,d,i,a,u,f,c-1),this.addQuad_(d,l,n,r,f,u,o,s,c-1)}else{let l=[(e[0]+t[0])/2,(e[1]+t[1])/2],u=this.transformInv_(l),d=[(n[0]+r[0])/2,(n[1]+r[1])/2],f=this.transformInv_(d);this.addQuad_(e,l,d,r,i,u,f,s,c-1),this.addQuad_(l,t,n,d,u,a,o,f,c-1)}return}}if(f){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}m&11||this.addTriangle_(e,n,r,i,o,s),m&14||this.addTriangle_(e,n,t,i,o,a),m&&(m&13||this.addTriangle_(t,r,e,a,s,i),m&7||this.addTriangle_(t,r,n,a,s,o))}calculateSourceExtent(){let e=Re();return this.triangles_.forEach(function(t,n,r){let i=t.source;oe(e,i[0]),oe(e,i[1]),oe(e,i[2])}),e}getTriangles(){return this.triangles_}},qr=class extends Mr{constructor(e,t,n,r,i,a,o,c,l,u,d,f){super(i,J.IDLE,f),this.renderEdges_=d===void 0?!1:d,this.pixelRatio_=o,this.gutter_=c,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=r,this.wrappedTileCoord_=a||i,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;let m=r.getTileCoordExtent(this.wrappedTileCoord_),h=this.targetTileGrid_.getExtent(),g=this.sourceTileGrid_.getExtent(),_=h?s(m,h):m;if(ue(_)===0){this.state=J.EMPTY;return}let v=e.getExtent();v&&(g=g?s(g,v):v);let y=r.getResolution(this.wrappedTileCoord_[0]),b=Hr(e,n,_,y);if(!isFinite(b)||b<=0){this.state=J.EMPTY;return}if(this.triangulation_=new Kr(e,n,_,g,b*(u===void 0?.5:u),y),this.triangulation_.getTriangles().length===0){this.state=J.EMPTY;return}this.sourceZ_=t.getZForResolution(b);let x=this.triangulation_.calculateSourceExtent();if(g&&(e.canWrapX()?(x[1]=Rt(x[1],g[1],g[3]),x[3]=Rt(x[3],g[1],g[3])):x=s(x,g)),!ue(x))this.state=J.EMPTY;else{let n=0,r=0;e.canWrapX()&&(n=P(v),r=Math.floor((x[0]-v[0])/n)),p(x.slice(),e,!0).forEach(e=>{let i=t.getTileRangeForExtentAndZ(e,this.sourceZ_);for(let e=i.minX;e<=i.maxX;e++)for(let t=i.minY;t<=i.maxY;t++){let i=l(this.sourceZ_,e,t,o);if(i){let e=r*n;this.sourceTiles_.push({tile:i,offset:e})}}++r}),this.sourceTiles_.length===0&&(this.state=J.EMPTY)}}getImage(){return this.canvas_}reproject_(){let e=[];if(this.sourceTiles_.forEach(t=>{let n=t.tile;if(n&&n.getState()==J.LOADED){let r=this.sourceTileGrid_.getTileCoordExtent(n.tileCoord);r[0]+=t.offset,r[2]+=t.offset;let i=this.clipExtent_?.slice();i&&(i[0]+=t.offset,i[2]+=t.offset),e.push({extent:r,clipExtent:i,image:n.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=J.ERROR;else{let t=this.wrappedTileCoord_[0],n=this.targetTileGrid_.getTileSize(t),r=typeof n==`number`?n:n[0],i=typeof n==`number`?n:n[1],a=this.targetTileGrid_.getResolution(t),o=this.sourceTileGrid_.getResolution(this.sourceZ_),s=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=Ur(r,i,this.pixelRatio_,o,this.sourceTileGrid_.getExtent(),a,s,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=J.LOADED}this.changed()}load(){if(this.state==J.IDLE){this.state=J.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{let n=t.getState();if(n==J.IDLE||n==J.LOADING){e++;let n=F(t,T.CHANGE,r=>{let i=t.getState();(i==J.LOADED||i==J.ERROR||i==J.EMPTY)&&(N(n),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(n)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:e},t,n){e.getState()==J.IDLE&&e.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(N),this.sourcesListenerKeys_=null}release(){this.canvas_&&=(u(this.canvas_.getContext(`2d`)),Lr.push(this.canvas_),null),super.release()}},Jr=class extends rn{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio===void 0?1:e.tilePixelRatio,this.tileGrid=e.tileGrid===void 0?null:e.tileGrid,this.tileGrid&&W(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),[256,256]),this.tmpSize=[0,0],this.key_=e.key||I(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){let t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,n,r,i,a){return De()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:gr(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,n){let r=this.getTileGridForProjection(n),i=this.getTilePixelRatio(t),a=W(r.getTileSize(e),this.tmpSize);return i==1?a:on(a,i,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){let n=t===void 0?this.getProjection():t,r=t===void 0&&this.tileGrid||this.getTileGridForProjection(n);return this.getWrapX()&&n.isGlobal()&&(e=_r(r,e,n)),lr(e,r)?e:null}clear(){}refresh(){this.clear(),super.refresh()}},Yr=class extends se{constructor(e,t){super(e),this.tile=t}},Xr=Jr,Zr={TILELOADSTART:`tileloadstart`,TILELOADEND:`tileloadend`,TILELOADERROR:`tileloaderror`},Qr=class e extends Xr{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===e.prototype.tileUrlFunction,this.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(this.tileUrlFunction=t.tileUrlFunction),this.urls=null,t.urls?this.setUrls(t.urls):t.url&&this.setUrl(t.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){let t=e.target,n=I(t),r=t.getState(),i;r==J.LOADING?(this.tileLoadingKeys_[n]=!0,i=Zr.TILELOADSTART):n in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[n],i=r==J.ERROR?Zr.TILELOADERROR:r==J.LOADED?Zr.TILELOADEND:void 0),i!=null&&this.dispatchEvent(new Yr(i,t))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,t===void 0?this.changed():this.setKey(t)}setUrl(e){let t=Or(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;let t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(Ar(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,n){}},$r=class extends Qr{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:ei,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate===void 0?!0:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin===void 0?null:e.crossOrigin,this.tileClass=e.tileClass===void 0?Fr:e.tileClass,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!En(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=`:disable-interpolation`),e}getTileGridForProjection(e){let t=this.getProjection();if(this.tileGrid&&(!t||En(t,e)))return this.tileGrid;let n=I(e);return n in this.tileGridForProjection||(this.tileGridForProjection[n]=gr(e)),this.tileGridForProjection[n]}createTile_(e,t,n,r,i,a){let o=[e,t,n],s=this.getTileCoordForTileUrlFunction(o,i),c=s?this.tileUrlFunction(s,r,i):void 0,l=new this.tileClass(o,c===void 0?J.EMPTY:J.IDLE,c===void 0?``:c,this.crossOrigin,this.tileLoadFunction,this.tileOptions);return l.key=a,l.addEventListener(T.CHANGE,this.handleTileChange.bind(this)),l}getTile(e,t,n,r,i,a){let o=this.getProjection();if(!o||!i||En(o,i))return this.getTileInternal(e,t,n,r,o||i);let s=[e,t,n],c=this.getKey(),l=new qr(o,this.getTileGridForProjection(o),i,this.getTileGridForProjection(i),s,this.getTileCoordForTileUrlFunction(s,i),this.getTilePixelRatio(r),this.getGutter(),(e,t,n,r)=>this.getTileInternal(e,t,n,r,o,a),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return l.key=c,l}getTileInternal(e,t,n,r,i,a){let o=this.getKey(),s=or(this,o,e,t,n);if(a&&a.containsKey(s))return a.get(s);let c=this.createTile_(e,t,n,r,i,o);return a?.set(s,c),c}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,t){let n=Yt(e);if(n){let e=I(n);e in this.tileGridForProjection||(this.tileGridForProjection[e]=t)}}};function ei(e,t){if(M){let n=e.getCrossOrigin(),r=`same-origin`,i=`same-origin`;n===`anonymous`||n===``?(r=`cors`,i=`omit`):n===`use-credentials`&&(r=`cors`,i=`include`),fetch(t,{mode:r,credentials:i}).then(e=>{if(!e.ok)throw Error(`HTTP ${e.status}`);return e.blob()}).then(e=>createImageBitmap(e)).then(t=>{let n=e.getImage();n.width=t.width,n.height=t.height,n.getContext(`2d`).drawImage(t,0,0),t.close?.(),n.dispatchEvent(new Event(`load`))}).catch(()=>{e.getImage().dispatchEvent(new Event(`error`))});return}e.getImage().src=t}var ti=$r,ni=class extends ti{constructor(e){e||={};let t=e.projection===void 0?`EPSG:3857`:e.projection,n=e.tileGrid===void 0?yr({extent:Sr(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize}):e.tileGrid;super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:n,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX===void 0?!0:e.wrapX,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter===void 0?0:e.gutter}getGutter(){return this.gutter_}};function ri(e){return e instanceof Image||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageBitmap?e:null}const ii=Error(`disposed`);var ai=[256,256],oi=class extends Mr{constructor(e){let t=J.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;let e=ri(this.data_);return e?[e.width,e.height]:ai}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==J.IDLE&&this.state!==J.ERROR)return;this.state=J.LOADING,this.changed();let e=this;this.loader_().then(function(t){e.data_=t,e.state=J.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=J.ERROR,e.changed()})}disposeInternal(){this.controller_&&=(this.controller_.abort(ii),null),super.disposeInternal()}},si=class{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,ze(this.queuedElements_)}dequeue(){let e=this.elements_,t=this.priorities_,n=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));let r=this.keyFunction_(n);return delete this.queuedElements_[r],n}enqueue(e){V(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");let t=this.priorityFunction_(e);return t==1/0?!1:(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0)}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){let t=this.elements_,n=this.priorities_,r=t.length,i=t[e],a=n[e],o=e;for(;e<r>>1;){let i=this.getLeftChildIndex_(e),a=this.getRightChildIndex_(e),o=a<r&&n[a]<n[i]?a:i;t[e]=t[o],n[e]=n[o],e=o}t[e]=i,n[e]=a,this.siftDown_(o,e)}siftDown_(e,t){let n=this.elements_,r=this.priorities_,i=n[t],a=r[t];for(;t>e;){let e=this.getParentIndex_(t);if(r[e]>a)n[t]=n[e],r[t]=r[e],t=e;else break}n[t]=i,r[t]=a}reprioritize(){let e=this.priorityFunction_,t=this.elements_,n=this.priorities_,r=0,i=t.length,a,o,s;for(o=0;o<i;++o)a=t[o],s=e(a),s==1/0?delete this.queuedElements_[this.keyFunction_(a)]:(n[r]=s,t[r++]=a);t.length=r,n.length=r,this.heapify_()}},ci=class extends si{constructor(e,t){super(t=>e.apply(null,t),e=>e[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){let t=super.enqueue(e);return t&&e[0].addEventListener(T.CHANGE,this.boundHandleTileChange_),t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){let t=e.target,n=t.getState();if(n===J.LOADED||n===J.ERROR||n===J.EMPTY){n!==J.ERROR&&t.removeEventListener(T.CHANGE,this.boundHandleTileChange_);let e=t.getKey();e in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[e],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let n=0;for(;this.tilesLoading_<e&&n<t&&this.getCount()>0;){let e=this.dequeue()[0],t=e.getKey();e.getState()===J.IDLE&&!(t in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[t]=!0,++this.tilesLoading_,++n,e.load())}}};function li(e,t,n,r,i){if(!e||!(n in e.wantedTiles)||!e.wantedTiles[n][t.getKey()])return 1/0;let a=e.viewState.center,o=r[0]-a[0],s=r[1]-a[1];return 65536*Math.log(i)+Math.sqrt(o*o+s*s)/i}function ui(e,t,n){if(!(n in e))return e[n]=new Set([t]),!0;let r=e[n],i=r.has(t);return i||r.add(t),!i}function di(e,t,n){let r=e[n];return r?r.delete(t):!1}function fi(e,t){let n=e.layerStatesArray[e.layerIndex];n.extent&&(t=s(t,Tn(n.extent,e.viewState.projection)));let r=n.layer.getRenderSource();if(!r.getWrapX()){let n=r.getTileGridForProjection(e.viewState.projection).getExtent();n&&(t=s(t,n))}return t}var pi=class extends Dt{constructor(e,t){super(e),t||={},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=Re(),this.tempTileRange_=new fr(0,0,0,0),this.tempTileCoord_=ir(0,0,0);let n=t.cacheSize===void 0?512:t.cacheSize;this.tileCache_=new rr(n),this.sourceTileCache_=null,this.maxStaleKeys=n*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||=new rr(512),this.sourceTileCache_}getOrCreateTile(e,t,n,r){let i=this.tileCache_,a=this.getLayer().getSource(),o=or(a,a.getKey(),e,t,n),s;if(i.containsKey(o))s=i.get(o);else{let c=r.viewState.projection,l=a.getProjection();if(s=a.getTile(e,t,n,r.pixelRatio,c,!l||En(l,c)?void 0:this.getSourceTileCache()),!s)return null;i.set(o,s)}return s}getTile(e,t,n,r){return this.getOrCreateTile(e,t,n,r)||null}getData(e){let t=this.frameState;if(!t)return null;let n=this.getLayer(),r=bn(t.pixelToCoordinateTransform,e.slice()),i=n.getExtent();if(i&&!Me(i,r))return null;let a=t.viewState,o=n.getRenderSource(),s=o.getTileGridForProjection(a.projection),c=o.getTilePixelRatio(t.pixelRatio);for(let e=s.getZForResolution(a.resolution);e>=s.getMinZoom();--e){let n=s.getTileCoordForCoordAndZ(r,e),i=this.getTile(e,n[1],n[2],t);if(!i||i.getState()!==J.LOADED)continue;let l=s.getOrigin(e),u=W(s.getTileSize(e)),d=s.getResolution(e),f;if(i instanceof Fr||i instanceof qr)f=i.getImage();else if(i instanceof oi){if(f=ri(i.getData()),!f)continue}else continue;let p=Math.floor(c*((r[0]-l[0])/d-n[1]*u[0])),m=Math.floor(c*((l[1]-r[1])/d-n[2]*u[1])),h=Math.round(c*o.getGutterForProjection(a.projection));return this.getImageData(f,p+h,m+h)}return null}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;let t=this.getLayer().getSource();if(!t)return!1;let n=t.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==n&&(this.renderedSourceRevision_=n,this.renderedSourceKey_===t.getKey()&&(this.tileCache_.clear(),this.sourceTileCache_?.clear())):this.renderedSourceRevision_=n,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(e,t,n,r,i){let a=e.viewState,o=this.getLayer(),s=o.getRenderSource(),c=s.getTileGridForProjection(a.projection),l=I(s);l in e.wantedTiles||(e.wantedTiles[l]={});let u=e.wantedTiles[l],d=o.getMapInternal(),f=Math.max(n-i,c.getMinZoom(),c.getZForResolution(Math.min(o.getMaxResolution(),d?d.getView().getResolutionForZoom(Math.max(o.getMinZoom(),0)):c.getResolution(0)),s.zDirection)),p=a.rotation,m=p?S(a.center,a.resolution,p,e.size):void 0;for(let i=n;i>=f;--i){let n=c.getTileRangeForExtentAndZ(t,i,this.tempTileRange_),a=c.getResolution(i);for(let t=n.minX;t<=n.maxX;++t)for(let o=n.minY;o<=n.maxY;++o){if(p&&!c.tileCoordIntersectsViewport([i,t,o],m))continue;let n=this.getTile(i,t,o,e);if(!n||!ui(r,n,i))continue;let s=n.getKey();if(u[s]=!0,n.getState()===J.IDLE&&!e.tileQueue.isKeyQueued(s)){let r=ir(i,t,o,this.tempTileCoord_);e.tileQueue.enqueue([n,l,c.getTileCoordCenter(r),a])}}}}findStaleTile_(e,t){let n=this.tileCache_,r=e[0],i=e[1],a=e[2],o=this.getStaleKeys();for(let e=0;e<o.length;++e){let s=or(this.getLayer().getSource(),o[e],r,i,a);if(n.containsKey(s)){let e=n.peek(s);if(e.getState()===J.LOADED)return e.endTransition(I(this)),ui(t,e,r),!0}}return!1}findAltTiles_(e,t,n,r){let i=e.getTileRangeForTileCoordAndZ(t,n,this.tempTileRange_);if(!i)return!1;let a=!0,o=this.tileCache_,s=this.getLayer().getRenderSource(),c=s.getKey();for(let e=i.minX;e<=i.maxX;++e)for(let t=i.minY;t<=i.maxY;++t){let i=or(s,c,n,e,t),l=!1;if(o.containsKey(i)){let e=o.peek(i);e.getState()===J.LOADED&&(ui(r,e,n),l=!0)}l||(a=!1)}return a}renderFrame(e,t){this.renderComplete=!0;let n=e.layerStatesArray[e.layerIndex],r=e.viewState,i=r.projection,a=r.resolution,o=r.center,c=e.pixelRatio,l=this.getLayer(),u=l.getSource(),d=u.getTileGridForProjection(i),f=d.getZForResolution(a,u.zDirection),p=d.getResolution(f),m=u.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==m&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=m):this.renderedSourceKey_=m;let h=e.extent,g=u.getTilePixelRatio(c);this.prepareContainer(e,t);let _=this.context.canvas.width,v=this.context.canvas.height,y=n.extent&&Tn(n.extent,i);y&&(h=s(h,Tn(n.extent,i)));let x=p*_/2/g,S=p*v/2/g,C=[o[0]-x,o[1]-S,o[0]+x,o[1]+S],w={};this.renderedTiles.length=0;let T=l.getPreload();if(e.nextExtent&&this.enqueueTilesForNextExtent()){let t=d.getZForResolution(r.nextResolution,u.zDirection),n=fi(e,e.nextExtent);this.enqueueTiles(e,n,t,w,T)}let E=fi(e,h);if(this.enqueueTiles(e,E,f,w,0),T>0&&setTimeout(()=>{this.enqueueTiles(e,E,f-1,w,T-1)},0),!(f in w))return this.container;let D=I(this),ee=e.time;for(let t of w[f]){let n=t.getState();if(n===J.EMPTY)continue;let r=t.tileCoord;if(n===J.LOADED&&t.getAlpha(D,ee)===1){t.endTransition(D);continue}if(n!==J.ERROR&&(this.renderComplete=!1),this.findStaleTile_(r,w)){di(w,t,f),e.animate=!0;continue}if(this.findAltTiles_(d,r,f+1,w))continue;let i=d.getMinZoom();for(let e=f-1;e>=i&&!this.findAltTiles_(d,r,e,w);--e);}let O=p/a*c/g,k=this.getRenderContext(e);pn(this.tempTransform,_/2,v/2,O,O,0,-_/2,-v/2),n.extent&&this.clipUnrotated(k,e,y),u.getInterpolate()||(k.imageSmoothingEnabled=!1),this.preRender(k,e);let A=Object.keys(w).map(Number);A.sort(te);let j,ne=[],re=[];for(let t=A.length-1;t>=0;--t){let n=A[t],r=u.getTilePixelSize(n,c,i),a=d.getResolution(n)/p,o=r[0]*a*O,s=r[1]*a*O,l=d.getTileCoordForCoordAndZ(Ee(C),n),f=d.getTileCoordExtent(l),m=bn(this.tempTransform,[g*(f[0]-C[0])/p,g*(C[3]-f[3])/p]),h=g*u.getGutterForProjection(i);for(let t of w[n]){if(t.getState()!==J.LOADED)continue;let r=t.tileCoord,i=l[1]-r[1],a=Math.round(m[0]-(i-1)*o),c=l[2]-r[2],d=Math.round(m[1]-(c-1)*s),f=Math.round(m[0]-i*o),p=Math.round(m[1]-c*s),g=a-f,_=d-p,v=A.length===1,y=!1;j=[f,p,f+g,p,f+g,p+_,f,p+_];for(let e=0,t=ne.length;e<t;++e)if(!v&&n<re[e]){let t=ne[e];b([f,p,f+g,p+_],[t[0],t[3],t[4],t[7]])&&(y||=(k.save(),!0),k.beginPath(),k.moveTo(j[0],j[1]),k.lineTo(j[2],j[3]),k.lineTo(j[4],j[5]),k.lineTo(j[6],j[7]),k.moveTo(t[6],t[7]),k.lineTo(t[4],t[5]),k.lineTo(t[2],t[3]),k.lineTo(t[0],t[1]),k.clip())}ne.push(j),re.push(n),this.drawTile(t,e,f,p,g,_,h,v),y&&k.restore(),this.renderedTiles.unshift(t),this.updateUsedTiles(e.usedTiles,u,t)}}return this.renderedResolution=p,this.extentChanged=!this.renderedExtent_||!xe(this.renderedExtent_,C),this.renderedExtent_=C,this.renderedPixelRatio=c,this.postRender(this.context,e),n.extent&&k.restore(),k.imageSmoothingEnabled=!0,this.renderComplete&&e.postRenderFunctions.push((e,t)=>{let n=I(u),r=t.wantedTiles[n],i=r?Object.keys(r).length:0;this.updateCacheSize(i),this.tileCache_.expireCache(),this.sourceTileCache_?.expireCache()}),this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,t,n,r,i,a,o,s){let c;if(e instanceof oi){if(c=ri(e.getData()),!c)throw Error(`Rendering array data is not yet supported`)}else c=this.getTileImage(e);if(!c)return;let l=this.getRenderContext(t),u=I(this),d=t.layerStatesArray[t.layerIndex],f=d.opacity*(s?e.getAlpha(u,t.time):1),p=f!==l.globalAlpha;p&&(l.save(),l.globalAlpha=f),l.drawImage(c,o,o,c.width-2*o,c.height-2*o,n,r,i,a),p&&l.restore(),f===d.opacity?s&&e.endTransition(u):t.animate=!0}getImage(){let e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,t,n){let r=I(t);r in e||(e[r]={}),e[r][n.getKey()]=!0}},mi={PRELOAD:`preload`,USE_INTERIM_TILES_ON_ERROR:`useInterimTilesOnError`},hi=class extends Xt{constructor(e){e||={};let t=Object.assign({},e),n=e.cacheSize;delete e.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=n,this.setPreload(e.preload===void 0?0:e.preload),this.setUseInterimTilesOnError(e.useInterimTilesOnError===void 0?!0:e.useInterimTilesOnError)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(mi.PRELOAD)}setPreload(e){this.set(mi.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(mi.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(mi.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}},gi=class extends hi{constructor(e){super(e)}createRenderer(){return new pi(this,{cacheSize:this.getCacheSize()})}},Y={ADDLAYER:`addlayer`,REMOVELAYER:`removelayer`},X=class extends se{constructor(e,t){super(e),this.layer=t}},_i={LAYERS:`layers`},vi=class e extends jt{constructor(e){e||={};let t=Object.assign({},e);delete t.layers;let n=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(_i.LAYERS,this.handleLayersChanged_),n?Array.isArray(n)?n=new U(n.slice(),{unique:!0}):V(typeof n.getArray==`function`,"Expected `layers` to be an array or a `Collection`"):n=new U(void 0,{unique:!0}),this.setLayers(n)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(N),this.layersListenerKeys_.length=0;let e=this.getLayers();for(let t in this.layersListenerKeys_.push(F(e,H.ADD,this.handleLayersAdd_,this),F(e,H.REMOVE,this.handleLayersRemove_,this)),this.listenerKeys_)this.listenerKeys_[t].forEach(N);ze(this.listenerKeys_);let t=e.getArray();for(let e=0,n=t.length;e<n;e++){let n=t[e];this.registerLayerListeners_(n),this.dispatchEvent(new X(Y.ADDLAYER,n))}this.changed()}registerLayerListeners_(t){let n=[F(t,l.PROPERTYCHANGE,this.handleLayerChange_,this),F(t,T.CHANGE,this.handleLayerChange_,this)];t instanceof e&&n.push(F(t,Y.ADDLAYER,this.handleLayerGroupAdd_,this),F(t,Y.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[I(t)]=n}handleLayerGroupAdd_(e){this.dispatchEvent(new X(Y.ADDLAYER,e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new X(Y.REMOVELAYER,e.layer))}handleLayersAdd_(e){let t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new X(Y.ADDLAYER,t)),this.changed()}handleLayersRemove_(e){let t=e.element,n=I(t);this.listenerKeys_[n].forEach(N),delete this.listenerKeys_[n],this.dispatchEvent(new X(Y.REMOVELAYER,t)),this.changed()}getLayers(){return this.get(_i.LAYERS)}setLayers(e){let t=this.getLayers();if(t){let e=t.getArray();for(let t=0,n=e.length;t<n;++t)this.dispatchEvent(new X(Y.REMOVELAYER,e[t]))}this.set(_i.LAYERS,e)}getLayersArray(e){return e=e===void 0?[]:e,this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){let t=e===void 0?[]:e,n=t.length;this.getLayers().forEach(function(e){e.getLayerStatesArray(t)});let r=this.getLayerState(),i=r.zIndex;!e&&r.zIndex===void 0&&(i=0);for(let e=n,a=t.length;e<a;e++){let n=t[e];n.opacity*=r.opacity,n.visible=n.visible&&r.visible,n.maxResolution=Math.min(n.maxResolution,r.maxResolution),n.minResolution=Math.max(n.minResolution,r.minResolution),n.minZoom=Math.max(n.minZoom,r.minZoom),n.maxZoom=Math.min(n.maxZoom,r.maxZoom),r.extent!==void 0&&(n.extent===void 0?n.extent=r.extent:n.extent=s(n.extent,r.extent)),n.zIndex===void 0&&(n.zIndex=i)}return t}getSourceState(){return`ready`}},yi=class extends fe{constructor(e){super();let t=e.element;t&&!e.target&&!t.style.pointerEvents&&(t.style.pointerEvents=`auto`),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&this.element?.remove();for(let e=0,t=this.listenerKeys.length;e<t;++e)N(this.listenerKeys[e]);if(this.listenerKeys.length=0,this.map_=e,e){let t=this.target_??e.getOverlayContainerStopEvent();this.element&&t.appendChild(this.element),this.render!==O&&this.listenerKeys.push(F(e,G.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e==`string`?document.getElementById(e):e}},bi=class extends yi{constructor(e){e||={},super({element:document.createElement(`div`),render:e.render,target:e.target}),this.ulElement_=document.createElement(`ul`),this.collapsed_=e.collapsed===void 0?!0:e.collapsed,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible===void 0?!0:e.collapsible,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;let t=e.className===void 0?`ol-attribution`:e.className,n=e.tipLabel===void 0?`Attributions`:e.tipLabel,r=e.expandClassName===void 0?t+`-expand`:e.expandClassName,i=e.collapseLabel===void 0?``:e.collapseLabel,a=e.collapseClassName===void 0?t+`-collapse`:e.collapseClassName;typeof i==`string`?(this.collapseLabel_=document.createElement(`span`),this.collapseLabel_.textContent=i,this.collapseLabel_.className=a):this.collapseLabel_=i;let o=e.label===void 0?`i`:e.label;typeof o==`string`?(this.label_=document.createElement(`span`),this.label_.textContent=o,this.label_.className=r):this.label_=o;let s=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement(`button`),this.toggleButton_.setAttribute(`type`,`button`),this.toggleButton_.setAttribute(`aria-expanded`,String(!this.collapsed_)),this.toggleButton_.title=n,this.toggleButton_.appendChild(s),this.toggleButton_.addEventListener(T.CLICK,this.handleClick_.bind(this),!1);let c=t+` `+le+` `+je+(this.collapsed_&&this.collapsible_?` `+Le:``)+(this.collapsible_?``:` ol-uncollapsible`),l=this.element;l.className=c,l.appendChild(this.toggleButton_),l.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){let t=this.getMap().getAllLayers(),n=new Set(t.flatMap(t=>t.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(e=>n.add(e)):n.add(this.attributions_)),!this.overrideCollapsible_){let e=!t.some(e=>e.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(e)}return Array.from(n)}async updateElement_(e){if(!e){this.renderedVisible_&&=(this.element.style.display=`none`,!1);return}let t=await Promise.all(this.collectSourceAttributions_(e).map(e=>Ve(()=>e))),n=t.length>0;if(this.renderedVisible_!=n&&(this.element.style.display=n?``:`none`,this.renderedVisible_=n),!C(t,this.renderedAttributions_)){_(this.ulElement_);for(let e=0,n=t.length;e<n;++e){let n=document.createElement(`li`);n.innerHTML=t[e],this.ulElement_.appendChild(n)}this.renderedAttributions_=t}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(Le),this.collapsed_?h(this.collapseLabel_,this.label_):h(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute(`aria-expanded`,String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle(`ol-uncollapsible`),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}},xi=class extends yi{constructor(e){e||={},super({element:document.createElement(`div`),render:e.render,target:e.target});let t=e.className===void 0?`ol-rotate`:e.className,n=e.label===void 0?``:e.label,r=e.compassClassName===void 0?`ol-compass`:e.compassClassName;this.label_=null,typeof n==`string`?(this.label_=document.createElement(`span`),this.label_.className=r,this.label_.textContent=n):(this.label_=n,this.label_.classList.add(r));let i=e.tipLabel?e.tipLabel:`Reset rotation`,a=document.createElement(`button`);a.className=t+`-reset`,a.setAttribute(`type`,`button`),a.title=i,a.appendChild(this.label_),a.addEventListener(T.CLICK,this.handleClick_.bind(this),!1);let o=t+` `+le+` `+je,s=this.element;s.className=o,s.appendChild(a),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration===void 0?250:e.duration,this.autoHide_=e.autoHide===void 0?!0:e.autoHide,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Ie)}handleClick_(e){e.preventDefault(),this.callResetNorth_===void 0?this.resetNorth_():this.callResetNorth_()}resetNorth_(){let e=this.getMap().getView();if(!e)return;let t=e.getRotation();t!==void 0&&(this.duration_>0&&t%(2*Math.PI)!=0?e.animate({rotation:0,duration:this.duration_,easing:nn}):e.setRotation(0))}render(e){let t=e.frameState;if(!t)return;let n=t.viewState.rotation;if(n!=this.rotation_){let e=`rotate(`+n+`rad)`;if(this.autoHide_){let e=this.element.classList.contains(Ie);!e&&n===0?this.element.classList.add(Ie):e&&n!==0&&this.element.classList.remove(Ie)}this.label_.style.transform=e}this.rotation_=n}},Si=class extends yi{constructor(e){e||={},super({element:document.createElement(`div`),target:e.target});let t=e.className===void 0?`ol-zoom`:e.className,n=e.delta===void 0?1:e.delta,r=e.zoomInClassName===void 0?t+`-in`:e.zoomInClassName,i=e.zoomOutClassName===void 0?t+`-out`:e.zoomOutClassName,a=e.zoomInLabel===void 0?`+`:e.zoomInLabel,o=e.zoomOutLabel===void 0?``:e.zoomOutLabel,s=e.zoomInTipLabel===void 0?`Zoom in`:e.zoomInTipLabel,c=e.zoomOutTipLabel===void 0?`Zoom out`:e.zoomOutTipLabel,l=document.createElement(`button`);l.className=r,l.setAttribute(`type`,`button`),l.title=s,l.appendChild(typeof a==`string`?document.createTextNode(a):a),l.addEventListener(T.CLICK,this.handleClick_.bind(this,n),!1);let u=document.createElement(`button`);u.className=i,u.setAttribute(`type`,`button`),u.title=c,u.appendChild(typeof o==`string`?document.createTextNode(o):o),u.addEventListener(T.CLICK,this.handleClick_.bind(this,-n),!1);let d=t+` `+le+` `+je,f=this.element;f.className=d,f.appendChild(l),f.appendChild(u),this.duration_=e.duration===void 0?250:e.duration}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){let t=this.getMap().getView();if(!t)return;let n=t.getZoom();if(n!==void 0){let r=t.getConstrainedZoom(n+e);this.duration_>0?(t.getAnimating()&&t.cancelAnimations(),t.animate({zoom:r,duration:this.duration_,easing:nn})):t.setZoom(r)}}};function Ci(e){e||={};let t=new U;return(e.zoom===void 0||e.zoom)&&t.push(new Si(e.zoomOptions)),(e.rotate===void 0||e.rotate)&&t.push(new xi(e.rotateOptions)),(e.attribution===void 0||e.attribution)&&t.push(new bi(e.attributionOptions)),t}var Z={SINGLECLICK:`singleclick`,CLICK:T.CLICK,DBLCLICK:T.DBLCLICK,POINTERDRAG:`pointerdrag`,POINTERMOVE:`pointermove`,POINTERDOWN:`pointerdown`,POINTERUP:`pointerup`,POINTEROVER:`pointerover`,POINTEROUT:`pointerout`,POINTERENTER:`pointerenter`,POINTERLEAVE:`pointerleave`,POINTERCANCEL:`pointercancel`},wi={ACTIVE:`active`},Ti=class extends fe{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(wi.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(wi.ACTIVE,e)}setMap(e){this.map_=e}};function Ei(e,t,n){let r=e.getCenterInternal();if(r){let i=[r[0]+t[0],r[1]+t[1]];e.animateInternal({duration:n===void 0?250:n,easing:dn,center:e.getConstrainedCenter(i)})}}function Di(e,t,n,r){let i=e.getZoom();if(i===void 0)return;let a=e.getConstrainedZoom(i+t),o=e.getResolutionForZoom(a);e.getAnimating()&&e.cancelAnimations(),e.animate({resolution:o,anchor:n,duration:r===void 0?250:r,easing:nn})}var Oi=Ti,ki=class extends Oi{constructor(e){super(),e||={},this.delta_=e.delta?e.delta:1,this.duration_=e.duration===void 0?250:e.duration}handleEvent(e){let t=!1;if(e.type==Z.DBLCLICK){let n=e.originalEvent,r=e.map,i=e.coordinate,a=n.shiftKey?-this.delta_:this.delta_;Di(r.getView(),a,i,this.duration_),n.preventDefault(),t=!0}return!t}};function Ai(e){let t=arguments;return function(e){let n=!0;for(let r=0,i=t.length;r<i&&(n&&=t[r](e),n);++r);return n}}const ji=function(e){let t=e.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},Mi=function(e){let t=e.map.getTargetElement(),n=t.getRootNode(),r=e.map.getOwnerDocument().activeElement;return n instanceof ShadowRoot?n.host.contains(r):t.contains(r)},Ni=function(e){let t=e.map.getTargetElement(),n=t.getRootNode();return(n instanceof ShadowRoot?n.host:t).hasAttribute(`tabindex`)?Mi(e):!0},Pi=Ue,Fi=function(t){let n=t.originalEvent;return`pointerId`in n&&n.button==0&&!(e&&ie&&n.ctrlKey)},Ii=function(e){let t=e.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},Li=function(e){let t=e.originalEvent;return ie?t.metaKey:t.ctrlKey},Ri=function(e){let t=e.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},zi=function(e){let t=e.originalEvent,n=t.target.tagName;return n!==`INPUT`&&n!==`SELECT`&&n!==`TEXTAREA`&&!t.target.isContentEditable},Bi=function(e){let t=e.originalEvent;return`pointerId`in t&&t.pointerType==`mouse`},Vi=function(e){let t=e.originalEvent;return`pointerId`in t&&t.isPrimary&&t.button===0};var Hi=class extends x{constructor(e){super(),this.geometry_=null,this.element_=document.createElement(`div`),this.element_.style.position=`absolute`,this.element_.style.pointerEvents=`auto`,this.element_.className=`ol-box `+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){let e=this.startPixel_,t=this.endPixel_,n=this.element_.style;n.left=Math.min(e[0],t[0])+`px`,n.top=Math.min(e[1],t[1])+`px`,n.width=Math.abs(t[0]-e[0])+`px`,n.height=Math.abs(t[1]-e[1])+`px`}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);let e=this.element_.style;e.left=`inherit`,e.top=`inherit`,e.width=`inherit`,e.height=`inherit`}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;let e=this.startPixel_,t=this.endPixel_,n=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);n[4]=n[0].slice(),this.geometry_?this.geometry_.setCoordinates([n]):this.geometry_=new Vt([n])}getGeometry(){return this.geometry_}},Ui=class extends Oi{constructor(e){e||={},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence)e.type==Z.POINTERDRAG?(this.handleDragEvent(e),e.originalEvent.preventDefault()):e.type==Z.POINTERUP&&(this.handlingDownUpSequence=this.handleUpEvent(e)&&this.targetPointers.length>0);else if(e.type==Z.POINTERDOWN){let n=this.handleDownEvent(e);this.handlingDownUpSequence=n,t=this.stopDown(n)}else e.type==Z.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}};function Wi(e){let t=e.length,n=0,r=0;for(let i=0;i<t;i++)n+=e[i].clientX,r+=e[i].clientY;return{clientX:n/t,clientY:r/t}}var Gi=Ui,Ki={BOXSTART:`boxstart`,BOXDRAG:`boxdrag`,BOXEND:`boxend`,BOXCANCEL:`boxcancel`},qi=class extends se{constructor(e,t,n){super(e),this.coordinate=t,this.mapBrowserEvent=n}},Ji=class extends Gi{constructor(e){super(),this.on,this.once,this.un,e??={},this.box_=new Hi(e.className||`ol-dragbox`),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??Fi,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,t,n){let r=n[0]-t[0],i=n[1]-t[1];return r*r+i*i>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new qi(Ki.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;let t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new qi(t?Ki.BOXEND:Ki.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new qi(Ki.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&=(this.dispatchEvent(new qi(Ki.BOXCANCEL,this.startPixel_,null)),null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&=(this.dispatchEvent(new qi(Ki.BOXCANCEL,this.startPixel_,null)),null)),super.setMap(e)}},Yi=class extends Gi{constructor(e){super({stopDown:de}),e||={},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;let t=e.condition?e.condition:Ai(Ii,Vi);this.condition_=e.onFocusOnly?Ai(Ni,t):t,this.noKinetic_=!1}handleDragEvent(e){let t=e.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());let n=this.targetPointers,r=t.getEventPixel(Wi(n));if(n.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){let t=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],n=e.map.getView();Gt(t,n.getResolution()),Ut(t,n.getRotation()),n.adjustCenterInternal(t)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=n.length,e.originalEvent.preventDefault()}handleUpEvent(e){let t=e.map,n=t.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){let e=this.kinetic_.getDistance(),r=this.kinetic_.getAngle(),i=n.getCenterInternal(),a=t.getPixelFromCoordinateInternal(i),o=t.getCoordinateFromPixelInternal([a[0]-e*Math.cos(r),a[1]-e*Math.sin(r)]);n.animateInternal({center:n.getConstrainedCenter(o),duration:500,easing:nn})}return this.panning_&&(this.panning_=!1,n.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){let t=e.map.getView();return this.lastCentroid=null,t.getAnimating()&&t.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}},Xi=class extends Gi{constructor(e){e||={},super({stopDown:de}),this.condition_=e.condition?e.condition:ji,this.lastAngle_=void 0,this.duration_=e.duration===void 0?250:e.duration}handleDragEvent(e){if(!Bi(e))return;let t=e.map,n=t.getView();if(n.getConstraints().rotation===un)return;let r=t.getSize(),i=e.pixel,a=Math.atan2(r[1]/2-i[1],i[0]-r[0]/2);if(this.lastAngle_!==void 0){let e=a-this.lastAngle_;n.adjustRotationInternal(-e)}this.lastAngle_=a}handleUpEvent(e){return Bi(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return Bi(e)&&Fi(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}},Zi=class extends Ji{constructor(e){e||={};let t=e.condition?e.condition:Ri;super({condition:t,className:e.className||`ol-dragzoom`,minArea:e.minArea}),this.duration_=e.duration===void 0?200:e.duration,this.out_=e.out===void 0?!1:e.out}onBoxEnd(e){let t=this.getMap().getView(),n=this.getGeometry();if(this.out_){let e=t.rotatedExtentForGeometry(n),r=t.getResolutionForExtentInternal(e),i=t.getResolution()/r;n=n.clone(),n.scale(i*i)}t.fitInternal(n,{duration:this.duration_,easing:nn})}},Qi=class extends se{constructor(e,t,n){super(e),this.map=t,this.frameState=n===void 0?null:n}},Q=class extends Qi{constructor(e,t,n,r,i,a){super(e,t,i),this.originalEvent=n,this.pixel_=null,this.coordinate_=null,this.dragging=r===void 0?!1:r,this.activePointers=a}get pixel(){return this.pixel_||=this.map.getEventPixel(this.originalEvent),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||=this.map.getCoordinateFromPixel(this.pixel),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),`preventDefault`in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),`stopPropagation`in this.originalEvent&&this.originalEvent.stopPropagation()}},$i={LEFT:`ArrowLeft`,UP:`ArrowUp`,RIGHT:`ArrowRight`,DOWN:`ArrowDown`},ea=class extends Oi{constructor(e){super(),e||={},this.defaultCondition_=function(e){return Ii(e)&&zi(e)},this.condition_=e.condition===void 0?this.defaultCondition_:e.condition,this.duration_=e.duration===void 0?100:e.duration,this.pixelDelta_=e.pixelDelta===void 0?128:e.pixelDelta}handleEvent(e){let t=!1;if(e.type==T.KEYDOWN){let n=e.originalEvent,r=n.key;if(this.condition_(e)&&(r==$i.DOWN||r==$i.LEFT||r==$i.RIGHT||r==$i.UP)){let i=e.map.getView(),a=i.getResolution()*this.pixelDelta_,o=0,s=0;r==$i.DOWN?s=-a:r==$i.LEFT?o=-a:r==$i.RIGHT?o=a:s=a;let c=[o,s];Ut(c,i.getRotation()),Ei(i,c,this.duration_),n.preventDefault(),t=!0}}return!t}},ta=class extends Oi{constructor(e){super(),e||={},this.condition_=e.condition?e.condition:function(e){return!Li(e)&&zi(e)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration===void 0?100:e.duration}handleEvent(e){let t=!1;if(e.type==T.KEYDOWN||e.type==T.KEYPRESS){let n=e.originalEvent,r=n.key;if(this.condition_(e)&&(r===`+`||r===`-`)){let i=e.map,a=r===`+`?this.delta_:-this.delta_;Di(i.getView(),a,void 0,this.duration_),n.preventDefault(),t=!0}}return!t}},na=40,ra=300,ia=class extends Oi{constructor(e){e||={},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta===void 0?1:e.maxDelta,this.duration_=e.duration===void 0?250:e.duration,this.timeout_=e.timeout===void 0?80:e.timeout,this.useAnchor_=e.useAnchor===void 0?!0:e.useAnchor,this.constrainResolution_=e.constrainResolution===void 0?!1:e.constrainResolution;let t=e.condition?e.condition:Pi;this.condition_=e.onFocusOnly?Ai(Ni,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;let e=this.getMap();e&&e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==T.WHEEL)return!0;let t=e.map,n=e.originalEvent;n.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let r=n.deltaY;switch(n.deltaMode){case WheelEvent.DOM_DELTA_LINE:r*=na;break;case WheelEvent.DOM_DELTA_PAGE:r*=ra;break;default:}if(r===0)return!1;this.lastDelta_=r;let i=Date.now();this.startTime_===void 0&&(this.startTime_=i),(!this.mode_||i-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(r)<4?`trackpad`:`wheel`);let a=t.getView();if(this.mode_===`trackpad`&&!(a.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(a.getAnimating()&&a.cancelAnimations(),a.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),a.adjustZoom(-r/this.deltaPerZoom_,this.lastAnchor_?t.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=i,!1;this.totalDelta_+=r;let o=Math.max(this.timeout_-(i-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,t),o),!1}handleWheelZoom_(e){let t=e.getView();t.getAnimating()&&t.cancelAnimations();let n=-Rt(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(n=n?n>0?1:-1:0),Di(t,n,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}},aa=class extends Gi{constructor(e){e||={};let t=e;t.stopDown||=de,super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold===void 0?.3:e.threshold,this.duration_=e.duration===void 0?250:e.duration}handleDragEvent(e){let t=0,n=this.targetPointers[0],r=this.targetPointers[1],i=Math.atan2(r.clientY-n.clientY,r.clientX-n.clientX);if(this.lastAngle_!==void 0){let e=i-this.lastAngle_;this.rotationDelta_+=e,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=e}this.lastAngle_=i;let a=e.map,o=a.getView();o.getConstraints().rotation!==un&&(this.anchor_=a.getCoordinateFromPixelInternal(a.getEventPixel(Wi(this.targetPointers))),this.rotating_&&(a.render(),o.adjustRotationInternal(t,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){let t=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}},oa=class extends Gi{constructor(e){e||={};let t=e;t.stopDown||=de,super(t),this.anchor_=null,this.duration_=e.duration===void 0?400:e.duration,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let t=1,n=this.targetPointers[0],r=this.targetPointers[1],i=n.clientX-r.clientX,a=n.clientY-r.clientY,o=Math.sqrt(i*i+a*a);this.lastDistance_!==void 0&&(t=this.lastDistance_/o),this.lastDistance_=o;let s=e.map,c=s.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=s.getCoordinateFromPixelInternal(s.getEventPixel(Wi(this.targetPointers))),s.render(),c.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){let t=e.map.getView(),n=this.lastScaleDelta_>1?1:-1;return t.endInteraction(this.duration_,n),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){let t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}},sa=class{constructor(e,t,n){this.decay_=e,this.minVelocity_=t,this.delay_=n,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,t){this.points_.push(e,t,Date.now())}end(){if(this.points_.length<6)return!1;let e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;let n=t-3;for(;n>0&&this.points_[n+2]>e;)n-=3;let r=this.points_[t+2]-this.points_[n+2];if(r<1e3/60)return!1;let i=this.points_[t]-this.points_[n],a=this.points_[t+1]-this.points_[n+1];return this.angle_=Math.atan2(a,i),this.initialVelocity_=Math.sqrt(i*i+a*a)/r,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}};function ca(e){e||={};let t=new U,n=new sa(-.005,.05,100);return(e.altShiftDragRotate===void 0||e.altShiftDragRotate)&&t.push(new Xi),(e.doubleClickZoom===void 0||e.doubleClickZoom)&&t.push(new ki({delta:e.zoomDelta,duration:e.zoomDuration})),(e.dragPan===void 0||e.dragPan)&&t.push(new Yi({onFocusOnly:e.onFocusOnly,kinetic:n})),(e.pinchRotate===void 0||e.pinchRotate)&&t.push(new aa),(e.pinchZoom===void 0||e.pinchZoom)&&t.push(new oa({duration:e.zoomDuration})),(e.keyboard===void 0||e.keyboard)&&(t.push(new ea),t.push(new ta({delta:e.zoomDelta,duration:e.zoomDuration}))),(e.mouseWheelZoom===void 0||e.mouseWheelZoom)&&t.push(new ia({onFocusOnly:e.onFocusOnly,duration:e.zoomDuration})),(e.shiftDragZoom===void 0||e.shiftDragZoom)&&t.push(new Zi({duration:e.zoomDuration})),t}var la={POINTERMOVE:`pointermove`,POINTERDOWN:`pointerdown`,POINTERUP:`pointerup`,POINTEROVER:`pointerover`,POINTEROUT:`pointerout`,POINTERENTER:`pointerenter`,POINTERLEAVE:`pointerleave`,POINTERCANCEL:`pointercancel`},ua=class extends be{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===void 0?1:t,this.down_=null;let n=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=n,this.pointerdownListenerKey_=F(n,la.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=F(n,la.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(T.TOUCHMOVE,this.boundHandleTouchMove_,E?{passive:!1}:!1)}emulateClick_(e){let t=new Q(Z.CLICK,this.map_,e);this.dispatchEvent(t),this.clickTimeoutId_===void 0?this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;let t=new Q(Z.SINGLECLICK,this.map_,e);this.dispatchEvent(t)},250):(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new Q(Z.DBLCLICK,this.map_,e),this.dispatchEvent(t))}updateActivePointers_(e){let t=e,n=t.pointerId;if(t.type==Z.POINTERUP||t.type==Z.POINTERCANCEL){for(let e in delete this.trackedTouches_[n],this.trackedTouches_)if(this.trackedTouches_[e].target!==t.target){delete this.trackedTouches_[e];break}}else (t.type==Z.POINTERDOWN||t.type==Z.POINTERMOVE)&&(this.trackedTouches_[n]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);let t=new Q(Z.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(N),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);let t=new Q(Z.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,`target`,{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){let e=this.map_.getOwnerDocument();this.dragListenerKeys_.push(F(e,Z.POINTERMOVE,this.handlePointerMove_,this),F(e,Z.POINTERUP,this.handlePointerUp_,this),F(this.element_,Z.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==e&&this.dragListenerKeys_.push(F(this.element_.getRootNode(),Z.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;let t=new Q(Z.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;let t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new Q(Z.POINTERMOVE,this.map_,e,t))}handleTouchMove_(e){let t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof e.cancelable!=`boolean`||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&=(N(this.relayedListenerKey_),null),this.element_.removeEventListener(T.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&=(N(this.pointerdownListenerKey_),null),this.dragListenerKeys_.forEach(N),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}},$={LAYERGROUP:`layergroup`,SIZE:`size`,TARGET:`target`,VIEW:`view`},da=class extends x{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){De()}calculateMatrices2D(e){let t=e.viewState,n=e.coordinateToPixelTransform,r=e.pixelToCoordinateTransform;pn(n,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),en(r,n)}forEachFeatureAtCoordinate(e,t,n,r,i,a,o,s){let c,l=t.viewState;function u(e,t,n,r){return i.call(a,t,e?n:null,r)}let d=l.projection,f=qt(e.slice(),d),p=[[0,0]];if(d.canWrapX()&&r){let e=P(d.getExtent());p.push([-e,0],[e,0])}let m=t.layerStatesArray,h=m.length,g=[],_=[];for(let r=0;r<p.length;r++)for(let i=h-1;i>=0;--i){let a=m[i],d=a.layer;if(d.hasRenderer()&&Nt(a,l)&&o.call(s,d)){let i=d.getRenderer(),o=d.getSource();if(i&&o){let s=o.getWrapX()?f:e,l=u.bind(null,a.managed);_[0]=s[0]+p[r][0],_[1]=s[1]+p[r][1],c=i.forEachFeatureAtCoordinate(_,t,n,l,g)}if(c)return c}}if(g.length===0)return;let v=1/g.length;return g.forEach((e,t)=>e.distanceSq+=t*v),g.sort((e,t)=>e.distanceSq-t.distanceSq),g.some(e=>c=e.callback(e.feature,e.layer,e.geometry)),c}hasFeatureAtCoordinate(e,t,n,r,i,a){return this.forEachFeatureAtCoordinate(e,t,n,r,Ue,this,i,a)!==void 0}getMap(){return this.map_}renderFrame(e){De()}scheduleExpireIconCache(e){Cn.canExpireCache()&&e.postRenderFunctions.push(fa)}};function fa(e,t){Cn.expire()}var pa=da,ma=class extends pa{constructor(e){super(e),this.fontChangeListenerKey_=F(mn,l.PROPERTYCHANGE,e.redrawText,e),this.element_=M?i():document.createElement(`div`);let t=this.element_.style;t.position=`absolute`,t.width=`100%`,t.height=`100%`,t.zIndex=`0`,this.element_.className=le+` ol-layers`;let n=e.getViewport();n&&n.insertBefore(this.element_,n.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,t){let n=this.getMap();if(n.hasListener(e)){let r=new Kt(e,void 0,t);n.dispatchEvent(r)}}disposeInternal(){N(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&=(this.element_.style.display=`none`,!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(Wt.PRECOMPOSE,e);let t=e.layerStatesArray.sort((e,t)=>e.zIndex-t.zIndex);t.some(e=>e.layer instanceof yn&&e.layer.getDeclutter())&&(e.declutter={});let n=e.viewState;this.children_.length=0;let r=[],i=null;for(let a=0,o=t.length;a<o;++a){let o=t[a];e.layerIndex=a;let s=o.layer,c=s.getSourceState();if(!Nt(o,n)||c!=`ready`&&c!=`undefined`){s.unrender();continue}let l=s.render(e,i);l&&(l!==i&&(this.children_.push(l),i=l),r.push(o))}this.declutter(e,r),Pe(this.element_,this.children_);let a=this.getMap().getTargetElement();if(d(a)){let e=a.getContext(`2d`);for(let t of this.children_){let n=t.firstElementChild||t,r=t.style.backgroundColor;if(r&&(!d(n)||n.width>0)&&(e.fillStyle=r,e.fillRect(0,0,a.width,a.height)),d(n)&&n.width>0){let r=t.style.opacity||n.style.opacity;e.globalAlpha=r===``?1:Number(r);let i=n.style.transform;if(i)e.setTransform(...cn(i));else{let t=parseFloat(n.style.width)/n.width,r=parseFloat(n.style.height)/n.height;e.setTransform(t,0,0,r,0,0)}e.drawImage(n,0,0)}}e.globalAlpha=1,e.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent(Wt.POSTCOMPOSE,e),this.renderedVisible_||=(this.element_.style.display=``,!0),this.scheduleExpireIconCache(e)}declutter(e,t){if(e.declutter){for(let n=t.length-1;n>=0;--n){let r=t[n],i=r.layer;i.getDeclutter()&&i.renderDeclutter(e,r)}t.forEach(t=>t.layer.renderDeferred(e))}}};function ha(e){if(e instanceof Xt){e.setMapInternal(null);return}e instanceof vi&&e.getLayers().forEach(ha)}function ga(e,t){if(e instanceof Xt){e.setMapInternal(t);return}if(e instanceof vi){let n=e.getLayers().getArray();for(let e=0,r=n.length;e<r;++e)ga(n[e],t)}}var _a=class extends fe{constructor(e){super(),e||={},this.on,this.once,this.un;let t=va(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading===void 0?16:e.maxTilesLoading,this.pixelRatio_=e.pixelRatio===void 0?ne:e.pixelRatio,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=_n(),this.pixelToCoordinateTransform_=_n(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,M||(this.viewport_=document.createElement(`div`),this.viewport_.className=`ol-viewport`+(`ontouchstart`in window?` ol-touch`:``),this.viewport_.style.position=`relative`,this.viewport_.style.overflow=`hidden`,this.viewport_.style.width=`100%`,this.viewport_.style.height=`100%`,this.overlayContainer_=document.createElement(`div`),this.overlayContainer_.style.position=`absolute`,this.overlayContainer_.style.zIndex=`0`,this.overlayContainer_.style.width=`100%`,this.overlayContainer_.style.height=`100%`,this.overlayContainer_.style.pointerEvents=`none`,this.overlayContainer_.className=`ol-overlaycontainer`,this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement(`div`),this.overlayContainerStopEvent_.style.position=`absolute`,this.overlayContainerStopEvent_.style.zIndex=`0`,this.overlayContainerStopEvent_.style.width=`100%`,this.overlayContainerStopEvent_.style.height=`100%`,this.overlayContainerStopEvent_.style.pointerEvents=`none`,this.overlayContainerStopEvent_.className=`ol-overlaycontainer-stopevent`,this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,M||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=t.controls||(M?new U:Ci()),this.interactions=t.interactions||(M?new U:ca({onFocusOnly:!0})),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new ci(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener($.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener($.VIEW,this.handleViewChanged_),this.addChangeListener($.SIZE,this.handleSizeChanged_),this.addChangeListener($.TARGET,this.handleTargetChanged_),this.setProperties(t.values);let n=this;e.view&&!(e.view instanceof B)&&e.view.then(function(e){n.setView(new B(e))}),this.controls.addEventListener(H.ADD,e=>{e.element.setMap(this)}),this.controls.addEventListener(H.REMOVE,e=>{e.element.setMap(null)}),this.interactions.addEventListener(H.ADD,e=>{e.element.setMap(this)}),this.interactions.addEventListener(H.REMOVE,e=>{e.element.setMap(null)}),this.overlays_.addEventListener(H.ADD,e=>{this.addOverlayInternal_(e.element)}),this.overlays_.addEventListener(H.REMOVE,e=>{let t=e.element.getId();t!==void 0&&delete this.overlayIdIndex_[t.toString()],e.element.setMap(null)}),this.controls.forEach(e=>{e.setMap(this)}),this.interactions.forEach(e=>{e.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){ga(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){let t=e.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_?.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,t,n){if(!this.frameState_||!this.renderer_)return;let r=this.getCoordinateFromPixelInternal(e);n=n===void 0?{}:n;let i=n.hitTolerance===void 0?0:n.hitTolerance,a=n.layerFilter===void 0?Ue:n.layerFilter,o=n.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,i,o,t,null,a,null)}getFeaturesAtPixel(e,t){let n=[];return this.forEachFeatureAtPixel(e,function(e){n.push(e)},t),n}getAllLayers(){let e=[];function t(n){n.forEach(function(n){n instanceof vi?t(n.getLayers()):e.push(n)})}return t(this.getLayers()),e}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;let n=this.getCoordinateFromPixelInternal(e);t=t===void 0?{}:t;let r=t.layerFilter===void 0?Ue:t.layerFilter,i=t.hitTolerance===void 0?0:t.hitTolerance,a=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(n,this.frameState_,i,a,r,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){let t=this.viewport_.getBoundingClientRect(),n=this.getSize(),r=t.width/n[0],i=t.height/n[1],a=`changedTouches`in e?e.changedTouches[0]:e;return[(a.clientX-t.left)/r,(a.clientY-t.top)/i]}getTarget(){return this.get($.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return Mt(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){let t=this.frameState_;return t?bn(t.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){let t=this.overlayIdIndex_[e.toString()];return t===void 0?null:t}getInteractions(){return this.interactions}getLayerGroup(){return this.get($.LAYERGROUP)}setLayers(e){let t=this.getLayerGroup();if(e instanceof U){t.setLayers(e);return}let n=t.getLayers();n.clear(),n.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){let e=this.getLayerGroup().getLayerStatesArray();for(let t=0,n=e.length;t<n;++t){let n=e[t];if(!n.visible)continue;let r=n.layer.getRenderer();if(r&&!r.ready)return!0;let i=n.layer.getSource();if(i&&i.loading)return!0}return!1}getPixelFromCoordinate(e){let t=tn(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(e){let t=this.frameState_;return t?bn(t.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get($.SIZE)}getView(){return this.get($.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){let e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,t,n,r){return li(this.frameState_,e,t,n,r)}handleBrowserEvent(e,t){t||=e.type;let n=new Q(t,this,e);this.handleMapBrowserEvent(n)}handleMapBrowserEvent(e){if(!this.frameState_)return;let t=e.originalEvent,n=t.type;if(n===la.POINTERDOWN||n===T.WHEEL||n===T.KEYDOWN){let e=this.getOwnerDocument(),n=this.viewport_.getRootNode?this.viewport_.getRootNode():e,r=t.target,i=n instanceof ShadowRoot?n.host===r?n.host.ownerDocument:n:n===e?e.documentElement:n;if(this.overlayContainerStopEvent_.contains(r)||!i.contains(r))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){let t=this.getInteractions().getArray().slice();for(let n=t.length-1;n>=0;n--){let r=t[n];if(!(r.getMap()!==this||!r.getActive()||!this.getTargetElement())&&(!r.handleEvent(e)||e.propagationStopped))break}}}handlePostRender(){let e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let n=this.maxTilesLoading_,r=n;if(e){let t=e.viewHints;if(t[Pt.ANIMATING]||t[Pt.INTERACTING]){let t=Date.now()-e.time>8;n=t?0:8,r=t?0:2}}t.getTilesLoading()<n&&(t.reprioritize(),t.loadMoreTiles(n,r))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(Wt.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(Wt.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Qi(G.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Qi(G.LOADSTART,this,e))));let n=this.postRenderFunctions_;if(e)for(let t=0,r=n.length;t<r;++t)n[t](this,e);n.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let e=0,t=this.targetChangeHandlerKeys_.length;e<t;++e)N(this.targetChangeHandlerKeys_[e]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(T.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(T.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!d(this.targetElement_)){this.resizeObserver_?.unobserve(this.targetElement_);let e=this.targetElement_.getRootNode();e instanceof ShadowRoot&&this.resizeObserver_.unobserve(e.host),this.setSize(void 0)}let e=this.getTarget(),t=typeof e==`string`?document.getElementById(e):e;if(this.targetElement_=t,!t)this.renderer_&&=(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),null),this.animationDelayKey_&&=(cancelAnimationFrame(this.animationDelayKey_),void 0);else{if(d(t)||t.appendChild(this.viewport_),this.renderer_||=new ma(this),!d(t)){for(let e in this.mapBrowserEventHandler_=new ua(this,this.moveTolerance_),Z)this.mapBrowserEventHandler_.addEventListener(Z[e],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(T.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(T.WHEEL,this.boundHandleBrowserEvent_,E?{passive:!1}:!1);let e;if(this.keyboardEventTarget_)e=this.keyboardEventTarget_;else{let n=t.getRootNode();e=n instanceof ShadowRoot?n.host:t}if(this.targetChangeHandlerKeys_=[F(e,T.KEYDOWN,this.handleBrowserEvent,this),F(e,T.KEYPRESS,this.handleBrowserEvent,this)],t instanceof HTMLElement){let e=t.getRootNode();e instanceof ShadowRoot&&this.resizeObserver_.observe(e.host),this.resizeObserver_?.observe(t)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&=(N(this.viewPropertyListenerKey_),null),this.viewChangeListenerKey_&&=(N(this.viewChangeListenerKey_),null);let e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=F(e,l.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=F(e,T.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&=(this.layerGroupPropertyListenerKeys_.forEach(N),null);let e=this.getLayerGroup();e&&(this.handleLayerAdd_(new X(`addlayer`,e)),this.layerGroupPropertyListenerKeys_=[F(e,l.PROPERTYCHANGE,this.render,this),F(e,T.CHANGE,this.render,this),F(e,`addlayer`,this.handleLayerAdd_,this),F(e,`removelayer`,this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;let e=this.frameState_.layerStatesArray;for(let t=0,n=e.length;t<n;++t){let n=e[t].layer;n.hasRenderer()&&n.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){ha(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){let t=this.getSize(),n=this.getView(),r=this.frameState_,i=null;if(t!==void 0&&sn(t)&&n&&n.isDef()){let r=n.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=n.getState();if(i={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:k(a.center,a.resolution,a.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:a,viewHints:r,wantedTiles:{},mapId:I(this),renderTargets:{}},a.nextCenter&&a.nextResolution){let e=isNaN(a.nextRotation)?a.rotation:a.nextRotation;i.nextExtent=k(a.nextCenter,a.nextResolution,e,t)}}this.frameState_=i,this.renderer_.renderFrame(i),i&&(i.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,i.postRenderFunctions),r&&(!this.previousExtent_||!w(this.previousExtent_)&&!xe(i.extent,this.previousExtent_))&&(this.dispatchEvent(new Qi(G.MOVESTART,this,r)),this.previousExtent_=ge(this.previousExtent_)),this.previousExtent_&&!i.viewHints[Pt.ANIMATING]&&!i.viewHints[Pt.INTERACTING]&&!xe(i.extent,this.previousExtent_)&&(this.dispatchEvent(new Qi(G.MOVEEND,this,i)),Ce(i.extent,this.previousExtent_))),this.dispatchEvent(new Qi(G.POSTRENDER,this,i)),this.renderComplete_=(this.hasListener(G.LOADSTART)||this.hasListener(G.LOADEND)||this.hasListener(Wt.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0)}setLayerGroup(e){let t=this.getLayerGroup();t&&this.handleLayerRemove_(new X(`removelayer`,t)),this.set($.LAYERGROUP,e)}setSize(e){this.set($.SIZE,e)}setTarget(e){this.set($.TARGET,e)}setView(e){if(!e||e instanceof B){this.set($.VIEW,e);return}this.set($.VIEW,new B);let t=this;e.then(function(e){t.setView(new B(e))})}updateSize(){let e=this.getTargetElement(),t;if(e){let n,r;if(d(e))n=e.width,r=e.height;else{let t=getComputedStyle(e);n=e.offsetWidth-parseFloat(t.borderLeftWidth)-parseFloat(t.paddingLeft)-parseFloat(t.paddingRight)-parseFloat(t.borderRightWidth),r=e.offsetHeight-parseFloat(t.borderTopWidth)-parseFloat(t.paddingTop)-parseFloat(t.paddingBottom)-parseFloat(t.borderBottomWidth)}!isNaN(n)&&!isNaN(r)&&(t=[Math.max(0,n),Math.max(0,r)],!sn(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&Lt(`No map visible because the map container's width or height are 0.`))}let n=this.getSize();t&&(!n||!C(t,n))&&(this.setSize(t),this.updateViewportSize_(t))}updateViewportSize_(e){let t=this.getView();t&&t.setViewportSize(e)}};function va(e){let t=null;e.keyboardEventTarget!==void 0&&(t=typeof e.keyboardEventTarget==`string`?document.getElementById(e.keyboardEventTarget):e.keyboardEventTarget);let n={},r=e.layers&&typeof e.layers.getLayers==`function`?e.layers:new vi({layers:e.layers});n[$.LAYERGROUP]=r,n[$.TARGET]=e.target,n[$.VIEW]=e.view instanceof B?e.view:new B;let i;e.controls!==void 0&&(Array.isArray(e.controls)?i=new U(e.controls.slice()):(V(typeof e.controls.getArray==`function`,"Expected `controls` to be an array or an `ol/Collection.js`"),i=e.controls));let a;e.interactions!==void 0&&(Array.isArray(e.interactions)?a=new U(e.interactions.slice()):(V(typeof e.interactions.getArray==`function`,"Expected `interactions` to be an array or an `ol/Collection.js`"),a=e.interactions));let o;return e.overlays===void 0?o=new U:Array.isArray(e.overlays)?o=new U(e.overlays.slice()):(V(typeof e.overlays.getArray==`function`,"Expected `overlays` to be an array or an `ol/Collection.js`"),o=e.overlays),{controls:i,interactions:a,keyboardEventTarget:t,overlays:o,values:n}}var ya=_a,ba=class{#e=`https://t{0-7}.tianditu.gov.cn/`;#t=`e1f2618711e8858b50bb0a1d4a715fa9`;#n={vec:[`vec`,`cva`],img:[`img`,`cia`]};createTileLayerGroup(e,t){return new vi({layers:this.#n[e].map(e=>this.createTileLayer(e)),visible:t,properties:{name:e}})}createTileLayer(e){return new gi({source:this.createXYZSource(e)})}createXYZSource(e){return new ni({url:this.#e+e+`_w/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=`+e+`&STYLE=default&TILEMATRIXSET=w&FORMAT=tiles&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}&tk=`+this.#t,tileGrid:xa(Yt(`EPSG:3857`))})}};function xa(e){let t=e.getExtent(),n=Ee(t),r=P(t),i=Array(18),a=Array(18);for(let e=0;e<18;++e)i[e]=r/(256*2**e),a[e]=e;return new hr({origin:n,resolutions:i,matrixIds:a})}var Sa=Ct({__name:`index`,props:{defaultTdtLyrType:{type:String,default:`vec`}},emits:[`mapCreated`,`mapClick`],setup(e,{emit:t}){let n=L(!0),r,i,a,o,s,c=L(),l=null,u=null,d=[73.62,16.7,134.77,53.56],f=t,p=e,m=L(p.defaultTdtLyrType),h=[{label:``,value:`vec`},{label:``,value:`img`}];Ke(async()=>{a=new ba,g(),n.value=!1,_()}),Qe(()=>{ve(l),ve(u),l=null,u=null,r=null});function g(){o=a.createTileLayerGroup(`vec`,p.defaultTdtLyrType===`vec`),s=a.createTileLayerGroup(`img`,p.defaultTdtLyrType===`img`),i=new bi({collapsible:!1,attributions:`<span> & NavInfoGS20251508</span>`});let e=Ci({attribution:!1,rotate:!1,zoom:!1}).extend([i]),t=new B({center:[(d[0]+d[2])/2,(d[1]+d[3])/2],zoom:3,maxZoom:28,projection:`EPSG:4326`});r=new ya({target:c.value,layers:[o,s],view:t,controls:e,interactions:ca({doubleClickZoom:!1})}),f(`mapCreated`,r)}function _(){v(),u=r.on(`change:size`,v),l=r.on(`singleclick`,y)}function v(){let e=r.getSize()[0]<600;i.setCollapsible(e),i.setCollapsed(e)}function y(e){f(`mapClick`,e)}function b(e){e===`vec`?(o.setVisible(!0),s.setVisible(!1)):(o.setVisible(!1),s.setVisible(!0))}return(e,t)=>{let r=Kn,i=nr;return Et((Je(),st(`div`,{class:`map`,ref_key:`mapDivRef`,ref:c,"element-loading-text":`...`,"element-loading-background":`rgba(122, 122, 122, 0.8)`},[mt(r,{class:`map-switch`,modelValue:R(m),"onUpdate:modelValue":t[0]||=e=>$e(m)?m.value=e:null,options:h,onChange:b},null,8,[`modelValue`])])),[[i,R(n),void 0,{lock:!0}]])}}},[[`__scopeId`,`data-v-83e44569`]]);export{Sa as t};