import{On as e}from"./css-DE2uYh6k.js";import{V as t,Y as n,b as r,d as i,g as a,ht as o,k as s,m as c,nt as l,z as u}from"./index-BNJ4ukpi.js";import{n as d,o as f,s as p}from"./common-BFo5nAog.js";import{B as m,Jt as h,R as g,a as _,b as v,i as y,o as b,r as x}from"./BaseVector-B8axkkEv.js";import{t as S}from"./Vector-DFTA0oJ6.js";const C=[73.62,16.7,134.77,53.56];function w(e){return e.reduce((e,t)=>(t.checked&&e.push(t.id),t.children&&t.children.length>0&&e.push(...w(t.children)),e),[])}var T={class:`zones-render`},E=[`title`],D={__name:`index`,props:{treeDefaultProps:{type:Object,default:()=>({children:`children`,label:`label`})},data:{type:Array,default:()=>[]},name:{type:String,default:`zones-render`},visible:{type:Boolean,default:!1}},emits:[`popup`,`closePopup`],setup(e,{emit:D}){let O=e,k=r(`state`),A=r(`isMapCreated`),j=n(null),M=D,N=n(w(O.data)),P=null,F=null,I=new v({wrapX:!1}),L=new y({fill:new b({color:`rgba(255, 0, 0, 0.05)`}),stroke:new _({color:`rgba(255, 0, 0)`,width:.5})}),R=new S({source:I,zIndex:99,visible:O.visible,properties:{name:`${O.name}-zone`}}),z=new v({wrapX:!1}),B=new y({stroke:new _({color:`rgba(255, 0, 0)`,width:1,lineDash:[10,10]}),text:new x({placement:`line`,textAlign:`center`,textBaseline:`middle`,font:`bold 11px sans-serif`,fill:new b({color:`red`}),stroke:new _({color:`white`,width:3}),overflow:!0})}),V=new S({cmSource:z,zIndex:99,visible:O.visible,properties:{name:`${O.name}-cm`}});u(A,e=>{e&&(P=k.map,H())}),u(()=>O.visible,e=>{R.setVisible(e),d(F),e&&(K(),M(`closePopup`),j.value.getCurrentKey()&&j.value.setCurrentKey(null))});function H(){F=f(P,`highlight`).getSource(),P.addLayer(R),P.addLayer(V),O.data.forEach(e=>{e?.bounds&&(U(e),W(e)),e?.children?.length&&e.children.forEach(e=>{e?.bounds&&(U(e),W(e))})}),O.visible&&K()}function U(e){let t=new h({geometry:g(e.bounds)});t.setId(e.code),t.setStyle(L.clone()),t.setProperties({...e}),I.addFeature(t)}function W(e){let t=new h({geometry:new m(q(e.bounds))}),n=B.clone();n.getText().setText(e.centralMeridian??``),t.setStyle(n),I.addFeature(t)}function G(e){if(!e.bounds)return;let t=I.getFeatureById(e.code);if(t){d(F);let n=t.clone();n.setStyle(void 0),F.addFeature(n),P.getView().fit(t.getGeometry(),{duration:300,padding:[20,340,20,450],callback:()=>M(`popup`,e)})}}function K(){P.getView().fit(C,{duration:300,padding:[20,340,20,450]})}let q=(e,t=2)=>{if(!Array.isArray(e)||e.length!==4)return null;let[n,r,i,a]=e,o=n===132||n===133.5?135:(n+i)/2;return[[o,a+t],[o,r-t]]};return(n,r)=>{let u=p;return s(),c(`div`,T,[a(u,{ref_key:`treeRef`,ref:j,class:`custom-tree`,data:e.data,"node-key":`id`,props:e.treeDefaultProps,"default-expanded-keys":[1],"default-checked-keys":l(N),onNodeClick:G,"highlight-current":``},{default:t(({node:e,data:t})=>[i(`span`,{title:e.label},o(e.label),9,E)]),_:1},8,[`data`,`props`,`default-checked-keys`])])}}};export{D as t};